var closetimer=0,ddmenuitem=0,homemenuloaded=0;function mopen(a,b){"homemenu"==a&&0==homemenuloaded&&(basicahah(imasroot+"/gethomemenu.php?cid="+b,"homemenu"),homemenuloaded=1);mcancelclosetime();ddmenuitem?(ddmenuitem.style.visibility="hidden",ddmenuitem=null):(ddmenuitem=document.getElementById(a),ddmenuitem.style.visibility="visible")}function mclose(){ddmenuitem&&(ddmenuitem.style.visibility="hidden",ddmenuitem=null)}function mclosetime(){closetimer=window.setTimeout(mclose,250)}
function mcancelclosetime(){closetimer&&(window.clearTimeout(closetimer),closetimer=null)}function basicahah(a,b,c){null==c&&(c=" Fetching data... ");document.getElementById(b).innerHTML=c;c=!1;window.XMLHttpRequest?(req=new XMLHttpRequest,c=!0):window.ActiveXObject&&(req=new ActiveXObject("Microsoft.XMLHTTP"),c=!0);c&&(req.onreadystatechange=function(){basicahahDone(a,b)},req.open("GET",a,!0),req.send(""))}
function basicahahDone(a,b){4==req.readyState&&(200==req.status?document.getElementById(b).innerHTML=req.responseText:document.getElementById(b).innerHTML=" AHAH Error:\n"+req.status+"\n"+req.statusText)}function arraysearch(a,b){for(var c=0;c<b.length;c++)if(b[c]==a)return c;return-1}var tipobj=0,curtipel=null;
function tipshow(a,b,c){if("undefined"!=typeof c&&"touchstart"==c.type){if(curtipel==a)return tipout(),!1;jQuery(document).on("touchstart.tipshow",function(){tipout(a)})}curtipel!=a&&("object"!=typeof tipobj&&(tipobj=document.createElement("div"),tipobj.className="undefined"!=typeof window.imathasAssess?"dropdown-pane tooltip-pane":"tips",tipobj.setAttribute("role","tooltip"),tipobj.id="hovertipsholder",document.getElementsByTagName("body")[0].appendChild(tipobj)),curtipel=a,a.hasAttribute("data-tip")?
tipobj.innerHTML=a.getAttribute("data-tip"):tipobj.innerHTML=b,tipobj.style.left="5px",$(tipobj).stop(!0,!0).fadeIn(100),tipobj.setAttribute("aria-hidden","false"),a.setAttribute("aria-describedby","hovertipsholder"),"undefined"!=typeof usingASCIIMath&&"undefined"!=typeof noMathRender&&usingASCIIMath&&!noMathRender&&-1!=tipobj.innerHTML.indexOf("`")&&rendermathnode(tipobj),b=findPos(a),self.innerHeight?x=self.innerWidth:document.documentElement&&document.documentElement.clientHeight?x=document.documentElement.clientWidth:
document.body&&(x=document.body.clientWidth),c=0,"number"==typeof window.pageYOffset?c=window.pageXOffset:document.body&&(document.body.scrollLeft||document.body.scrollTop)?c=document.body.scrollLeft:document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)&&(c=document.documentElement.scrollLeft),x+=c,b[0]+tipobj.offsetWidth>x-10?(b[0]=x-tipobj.offsetWidth-30,$(tipobj).addClass("tipright")):$(tipobj).removeClass("tipright"),tipobj.style.left=b[0]+15+"px",
tipobj.style.top=30>b[1]?b[1]+20+"px":b[1]-tipobj.offsetHeight+"px")}function tipout(a){jQuery(document).off("touchstart.tipshow");$(tipobj).fadeOut(100);tipobj.setAttribute("aria-hidden","true");curtipel&&curtipel.removeAttribute("aria-describedby");curtipel=null}jQuery(function(){jQuery(document).on("keyup",function(a){27==a.which&&null!==curtipel&&tipout()})});var popupwins=[];
function popupwindow(a,b,c,d,f){"fit"==d&&(d=window.height-80);c="width="+c+",height="+d+",status=0,resizable=1,directories=0,menubar=0";null!=f&&1==f&&(c+=",scrollbars=1");"undefined"==typeof popupwins[a]||popupwins[a].closed||popupwins[a].focus();b.match(/^http/)?popupwins[a]=window.open(b,a,c):(f=window.open("",a,c),f.document.write("<html><head><title>Popup</title></head><body>"),f.document.write(b),f.document.write("</body></html>"),f.document.close(),popupwins[a]=f)}
function findPos(a){var b=curtop=0;if(a.offsetParent){do b+=a.offsetLeft,curtop+=a.offsetTop,a.offsetParent&&(a.parentNode&&a.offsetParent!=a.parentNode?(b-=a.parentNode.scrollLeft,curtop-=a.parentNode.scrollTop):(b-=a.offsetParent.scrollLeft,curtop-=a.offsetParent.scrollTop));while(a=a.offsetParent)}return[b,curtop]}
function togglepic(a){a.getAttribute("src").match("userimg_sm")?a.setAttribute("src",a.getAttribute("src").replace("_sm","_")):a.setAttribute("src",a.getAttribute("src").replace("_","_sm"))}function addLoadEvent(a){var b=window.onload;window.onload="function"!=typeof window.onload?a:function(){b&&b();a()}}
function submitlimiter(a){var b=a.target;if("submitted"==b.className)return alert("You have already submitted this page.  Please be patient while your submission is processed."),b.className="submitted2",a.preventDefault?a.preventDefault():a.returnValue=!1,!1;if("submitted2"==b.className)return a.preventDefault?a.preventDefault():a.returnValue=!1,!1;b.className="submitted";return!0}
function setupFormLimiters(){for(var a=document.getElementsByTagName("form"),b=0;b<a.length;b++)if("function"!=typeof a[b].onsubmit&&!a[b].className.match(/(nolimit|limitaftervalidate)/))$(a[b]).on("submit",submitlimiter)}addLoadEvent(setupFormLimiters);
function GB_move(a){a.preventDefault();if("touchmove"==a.type){a=a.originalEvent.changedTouches[0]||a.originalEvent.touches[0];var b=a.pageX;a=a.pageY}else b=a.pageX,a=a.pageY;var c=jQuery("#GB_window");c.css("left",Math.max(0,c.data("original_x")+(b-c.data("original_mouse_x")))).css("top",Math.max(0,c.data("original_y")+(a-c.data("original_mouse_y"))))}
function GB_drop(a){jQuery(window).off("touchmove.GBmove touchend.GBmove mousemove.GBmove mouseup.GBmove");jQuery("#GB_frameoverlay").remove();jQuery("body").css("user-select","")}
function GB_resize(a){a.preventDefault();if("touchmove"==a.type){a=a.originalEvent.changedTouches[0]||a.originalEvent.touches[0];var b=a.pageX,c=a.pageY}else b=a.pageX,c=a.pageY;b=Math.max(0,Math.min(b,document.documentElement.clientWidth-5));c=Math.max(0,Math.min(c,document.documentElement.clientHeight-5));a=jQuery("#GB_window");b-=a.data("original_mouse_x");c-=a.data("original_mouse_y");if(a[0].hasAttribute("data-lockratio")){var d=a.data("original_h")/a.data("original_w");(a.data("original_h")+
c)/(a.data("original_w")+b)>d?c=d*(a.data("original_w")+b)-a.data("original_h"):b=(a.data("original_h")+c)/d-a.data("original_w")}a.css("width",Math.max(0,a.data("original_w")+b)).css("height",Math.max(0,a.data("original_h")+c));$("#GB_frameholder").css("height",Math.max(0,a.data("original_h")+c)-36)}function GB_endresize(a){jQuery(window).off("touchmove.GBresize touchend.GBresize mousemove.GBresize mouseup.GBresize");jQuery("#GB_frameoverlay").remove();jQuery("body").css("user-select","")}
var GB_loaded=!1;
function GB_show(a,b,c,d,f,e,g){e=e||"";if(0==GB_loaded){var h=document.createElement("div");h.id="GB_overlay";h.onclick=GB_hide;document.getElementsByTagName("body")[0].appendChild(h);h=document.createElement("div");h.setAttribute("role","dialog");h.setAttribute("aria-labelledby","GB_title");h.setAttribute("tabindex",-1);h.id="GB_window";h.innerHTML='<div id="GB_caption"></div><div id="GB_loading">Loading...</div><div id="GB_frameholder" ></div><div id="GB_resizehandle"></div>';document.getElementsByTagName("body")[0].appendChild(h);
GB_loaded=!0;jQuery("#GB_caption").on("mousedown touchstart",function(k){if("input"!=k.target.nodeName.toLowerCase()&&"button"!=k.target.nodeName.toLowerCase()&&"a"!=k.target.nodeName.toLowerCase()){var n=document.getElementById("GB_window");if("touchstart"==k.type)var p=k.originalEvent.changedTouches[0]||k.originalEvent.touches[0];jQuery("#GB_window").data("original_x",n.getBoundingClientRect().left).data("original_y",n.getBoundingClientRect().top).data("original_mouse_x","touchstart"==k.type?p.pageX:
k.pageX).data("original_mouse_y","touchstart"==k.type?p.pageY:k.pageY).css("left",n.getBoundingClientRect().left).css("top",n.getBoundingClientRect().top).css("margin",0).css("right","").css("width",$(n).width());jQuery("#GB_window").append($("<div/>",{id:"GB_frameoverlay"}));jQuery("body").css("user-select","none");if("touchstart"==k.type)jQuery(window).on("touchmove.GBmove",GB_move).on("touchend.GBmove",GB_drop);else jQuery(window).on("mousemove.GBmove",GB_move).on("mouseup.GBmove",GB_drop)}});
jQuery("#GB_resizehandle").on("mousedown touchstart",function(k){if("touchstart"==k.type)var n=k.originalEvent.changedTouches[0]||k.originalEvent.touches[0];var p=document.getElementById("GB_window");jQuery("#GB_window").css("left",p.getBoundingClientRect().left).css("top",p.getBoundingClientRect().top).css("margin",0).css("right","").data("original_w",$(p).width()).data("original_h",$(p).height()).data("original_mouse_x","touchstart"==k.type?n.pageX:k.pageX).data("original_mouse_y","touchstart"==
k.type?n.pageY:k.pageY);jQuery("#GB_window").append($("<div/>",{id:"GB_frameoverlay"}));jQuery("body").css("user-select","none");if("touchstart"==k.type)jQuery(window).on("touchmove.GBresize",GB_resize).on("touchend.GBresize",GB_endresize);else jQuery(window).on("mousemove.GBresize",GB_resize).on("mouseup.GBresize",GB_endresize)})}document.getElementById("GB_loading").style.display="block";"<"==b.charAt(0)?(document.getElementById("GB_frameholder").innerHTML="<div>"+b+"</div>",b.match(/data-enlarged/)&&
jQuery("#GB_window").attr("data-lockratio",1),setTimeout(GB_doneload,50)):document.getElementById("GB_frame")&&document.getElementById("GB_frame").src.replace(/\/$/,"")==b.replace(/\/$/,"")?document.getElementById("GB_loading").style.display="none":document.getElementById("GB_frameholder").innerHTML='<iframe onload="GB_doneload()" id="GB_frame" src="'+b+'" title="'+a+'"></iframe>';jQuery("#GB_frameholder").isolatedScroll();b.match(/libtree/)?(document.getElementById("GB_caption").innerHTML='<span class="floatright"><input type="button" value="Use Libraries" onClick="document.getElementById(\'GB_frame\').contentWindow.setlib()" /> <a href="#" class="pointer" onclick="GB_hide();return false;" aria-label="Close">[X]</a>&nbsp;</span><span id="GB_title">Select Libraries</span><div class="clear"></div>',
a=self.innerHeight||de&&de.clientHeight||document.body.clientHeight):(document.getElementById("GB_caption").innerHTML='<span class="floatright"><a href="#" class="pointer" onclick="GB_hide();return false;" aria-label="Close">[X]</a></span><span id="GB_title">'+a+"</span>",document.getElementById("GB_caption").onclick=GB_hide,a="auto"==d?self.innerHeight||de&&de.clientHeight||document.body.clientHeight:d);document.getElementById("GB_window").style.display="block";!1!==f?document.getElementById("GB_overlay").style.display=
"block":document.getElementById("GB_overlay").style.display="none";f=$(document).width();c>f-20&&(c=f-20);if(!e.match(/noreset/)||!jQuery("#GB_window").data("original_mouse_x")||""==document.getElementById("GB_window").style.left){h="";if("object"==typeof g){var l,q;for(q in g)if(l=document.getElementById(g[q])){h=l.getBoundingClientRect().bottom+10;"auto"==d&&(a=window.self!==window.top?Math.min(600,self.innerHeight):self.innerHeight,a=Math.max(200,a-h-20));break}}$("#GB_window").css("margin","").css("left",
"").css("top",h);e.match(/left/)&&""==document.getElementById("GB_window").style.left?($("body").hasClass("fw1000")&&1E3<f&&(c+=(f-1E3)/2),$("body").hasClass("fw1920")&&1920<f&&(c+=(f-1920)/2),$("#GB_window").css("left",c).css("width","auto").css("right",20).css("margin","0"),c=f-c-20):document.getElementById("GB_window").style.width=c+"px";document.getElementById("GB_window").style.height=a-30+"px";"<"!=b.charAt(0)?document.getElementById("GB_frameholder").style.height=a-30-36+"px":document.getElementById("GB_frameholder").style.height=
"auto"}document.getElementById("GB_window").focus();$(document).on("keydown.GB",function(k){27==k.keyCode&&GB_hide()})}function GB_doneload(){document.getElementById("GB_loading").style.display="none"}function GB_hide(){document.getElementById("GB_window").style.display="none";document.getElementById("GB_overlay")&&(document.getElementById("GB_overlay").style.display="none");$(document).off("keydown.GB")}
function chkAllNone(a,b,c,d){a=document.getElementById(a);for(i=0;i<=a.elements.length;i++)try{if("all"==b&&"checkbox"==a.elements[i].type||a.elements[i].name==b)a.elements[i].checked=d&&a.elements[i].className==d?!c:c}catch(f){}return!1}var tinyMCEPreInit={base:imasroot+"/tinymce4"},desmos="";
function initeditor(a,b,c,d,f){c=c||0;var e=d||0;d="";"exact"==a?d="#"+b.split(/,/).join(",#"):"textareas"==a?d="textarea."+b:"divs"==a?d="div."+b:"selector"==a&&(d=b);a={selector:d,inline:e,plugins:[desmos+" noneditable lists advlist autolink attach image charmap anchor","searchreplace code link textcolor snippet","media table paste asciimath asciisvg rollups colorpicker"],noneditable_noneditable_class:"js-desmos",menubar:!1,toolbar1:"myEdit myInsert styleselect | bold italic underline subscript superscript | forecolor backcolor | snippet code | saveclose",
toolbar2:" alignleft aligncenter alignright | bullist numlist outdent indent  | attach link unlink image | table | asciimath asciimathcharmap asciisvg "+desmos,extended_valid_elements:"iframe[src|width|height|name|align|allowfullscreen|frameborder|style|class],param[name|value],@[sscr]",content_css:imasroot+(1==c?"/assessment/mathtest.css,":"/imascore.css,")+imasroot+"/themes/"+coursetheme+(""==desmos?"":","+imasroot+"/desmos/desmos-temp.css"),AScgiloc:imasroot+"/filter/graph/svgimg.php",convert_urls:!1,
file_picker_callback:filePickerCallBackFunc,file_picker_types:"file image",images_upload_url:imasroot+"/tinymce4/upload_handler.php",paste_data_images:!0,default_link_target:"_blank",browser_spellcheck:!0,branding:!1,resize:"both",width:"100%",content_style:"body {background-color: "+(coursetheme.match(/_dark/)?"#000":"#fff")+" !important;}",table_class_list:[{title:"None",value:""},{title:"Gridded",value:"gridded"},{title:"Gridded Centered",value:"gridded centered"}],style_formats_merge:!0,snippets:1==
tinymceUseSnippets?imasroot+"/tinymce4/getsnippets.php":!1,setup:function(g){g.on("change",function(){g.save()})},style_formats:[{title:"Font Family",items:[{title:"Arial",inline:"span",styles:{"font-family":"arial"}},{title:"Book Antiqua",inline:"span",styles:{"font-family":"book antiqua"}},{title:"Comic Sans MS",inline:"span",styles:{"font-family":"comic sans ms,sans-serif"}},{title:"Courier New",inline:"span",styles:{"font-family":"courier new,courier"}},{title:"Georgia",inline:"span",styles:{"font-family":"georgia,palatino"}},
{title:"Helvetica",inline:"span",styles:{"font-family":"helvetica"}},{title:"Impact",inline:"span",styles:{"font-family":"impact,chicago"}},{title:"Open Sans",inline:"span",styles:{"font-family":"Open Sans"}},{title:"Symbol",inline:"span",styles:{"font-family":"symbol"}},{title:"Tahoma",inline:"span",styles:{"font-family":"tahoma"}},{title:"Terminal",inline:"span",styles:{"font-family":"terminal,monaco"}},{title:"Times New Roman",inline:"span",styles:{"font-family":"times new roman,times"}},{title:"Verdana",
inline:"span",styles:{"font-family":"Verdana"}}]},{title:"Font Size",items:[{title:"x-small",inline:"span",styles:{fontSize:"x-small","font-size":"x-small"}},{title:"small",inline:"span",styles:{fontSize:"small","font-size":"small"}},{title:"medium",inline:"span",styles:{fontSize:"medium","font-size":"medium"}},{title:"large",inline:"span",styles:{fontSize:"large","font-size":"large"}},{title:"x-large",inline:"span",styles:{fontSize:"x-large","font-size":"x-large"}},{title:"xx-large",inline:"span",
styles:{fontSize:"xx-large","font-size":"xx-large"}}]}]};385>document.documentElement.clientWidth?(a.toolbar1="myEdit myInsert styleselect | bold italic underline | saveclose",a.toolbar2="bullist numlist outdent indent  | link image | asciimath asciisvg "+desmos):465>document.documentElement.clientWidth?(a.toolbar1="myEdit myInsert styleselect | bold italic underline forecolor | saveclose",a.toolbar2="bullist numlist outdent indent  | link unlink image | asciimath asciisvg "+desmos):575>document.documentElement.clientWidth&&
(a.toolbar1="myEdit myInsert styleselect | bold italic underline subscript superscript | forecolor | saveclose",a.toolbar2=" alignleft aligncenter | bullist numlist outdent indent  | link unlink image | asciimath asciimathcharmap asciisvg "+desmos);f&&(a.setup=f);tinymce.remove(d);tinymce.init(a)}
function filePickerCallBack(a,b,c){b=imasroot+"/tinymce4/file_manager.php";switch(c.filetype){case "image":b+="?type=img";break;case "file":b+="?type=files"}tinyMCE.activeEditor.windowManager.open({file:b,title:"File Manager",width:350,height:450,resizable:"yes",inline:"yes",close_previous:"no"},{oninsert:function(d,f){a(d)}})}
function imascleanup(a,b){"get_from_editor"==a&&(b=b.replace(/\x3c!--([\s\S]*?)--\x3e|&lt;!--([\s\S]*?)--&gt;|<style>[\s\S]*?<\/style>/g,""),b=b.replace(/class="?Mso\w+"?/g,""),b=b.replace(/<p\s*>\s*<\/p>/gi,""),b=b.replace(/<script.*?\/script>/gi,""),b=b.replace(/<input[^>]*button[^>]*>/gi,""));return b}
function readCookie(a){a+="=";for(var b=document.cookie.split(";"),c=0;c<b.length;c++){for(var d=b[c];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return unescape(d.substring(a.length,d.length))}return null}
function selectByDivID(a){var b=a.value;a=a.value.split(":")[0];for(var c=document.getElementsByTagName("div"),d=0;d<c.length;d++)c[d].className.match(a)&&(c[d].style.display=c[d].id==b?"block":"none");c=new Date;c.setDate(c.getDate()+365);document.cookie=a+"store="+escape(b)+";expires="+c.toGMTString()}
function setselectbycookie(){for(var a=document.getElementsByTagName("select"),b=0;b<a.length;b++)if(a[b].className.match("alts")){var c=a[b].className.replace(/alts/,"").replace(/\s/g,"");null!=(co=readCookie(c+"store"))&&(co=co.replace("store",""),a[b].value=co,selectByDivID(a[b]))}}addLoadEvent(setselectbycookie);var recordedunload=!1;
function recclick(a,b,c,d){if(0<cid){var f="",e;null!==(e=window.location.href.match(/showlinkedtext.*?&id=(\d+)/))&&0==recordedunload&&(f="&unloadinglinked="+e[1],recordedunload=!0);jQuery.ajax({type:"POST",url:imasroot+"/course/rectrack.php?cid="+cid,data:"type="+encodeURIComponent(a)+"&typeid="+encodeURIComponent(b)+"&info="+encodeURIComponent(c+"::"+d)+f})}}
function setuptracklinks(a,b){if(jQuery(b).attr("data-base"))jQuery(b).off("click.recclick").on("click.recclick",function(c){var d=jQuery(this).attr("data-base").split("-");recclick(d[0],d[1],jQuery(this).attr("href"),jQuery(this).clone().find(".sr-only").remove().end().text());if("undefined"==typeof jQuery(b).attr("target"))return c.preventDefault(),setTimeout('window.location.href = "'+jQuery(this).attr("href")+'"',100),!1}).off("mousedown.recclick").on("mousedown.recclick",function(c){3==c.which&&
(c=jQuery(this).attr("data-base").split("-"),recclick(c[0],c[1],jQuery(this).attr("href"),jQuery(this).clone().find(".sr-only").remove().end().text()))})}var videoembedcounter=0;
function togglevideoembed(){var a=this.id.substr(13),b=jQuery("#videoiframe"+a);if(0<b.length)"none"==b.css("display")?(b.show(),b.parent(".fluid-width-video-wrapper").show(),jQuery(this).text(" [-]").attr("title",_("Hide video")).attr("aria-label",_("Hide embedded video"))):(b.hide(),b.get(0).contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*"),b.parent(".fluid-width-video-wrapper").hide(),jQuery(this).text(" [+]"),jQuery(this).attr("title",_("Watch video here")),jQuery(this).attr("aria-label",
_("Embed video")+" "+jQuery(this).prev().text()));else{b=jQuery(this).prev().attr("href");var c="?";b=b.replace(/%3F/g,"?").replace(/%3D/g,"=");if(b.match(/youtube\.com/))if(-1<b.indexOf("playlist?list=")){var d=b.split("list=")[1].split(/[#&]/)[0],f="www.youtube.com/embed/videoseries?list=";c="&"}else d=b.match(/\/embed\//)?b.split("/embed/")[1].split(/[#&\?]/)[0]:b.split("v=")[1].split(/[#&]/)[0],f="www.youtube.com/embed/";else b.match(/youtu\.be/)?(d=b.split(".be/")[1].split(/[#&]/)[0],f="www.youtube.com/embed/"):
b.match(/vimeo/)&&(d=b.split(".com/")[1].split(/[#&]/)[0],f="player.vimeo.com/video/");var e=b.match(/.*\Wt=((\d+)m)?((\d+)s)?.*/);null==e?(c+="rel=0",e=b.match(/.*start=(\d+)/),null!=e&&(c+="&start="+e[1])):c=c+"rel=0&start="+((e[2]?60*e[2]:0)+(e[4]?1*e[4]:0));e=b.match(/.*end=(\d+)/);null!=e&&(c+="&end="+e[1]);d=jQuery("<iframe/>",{id:"videoiframe"+a,width:640,height:400,src:("https:"==location.protocol?"https:":"http:")+"//"+f+d+(c+"&enablejsapi=1"),frameborder:0,allowfullscreen:1});a=jQuery(this);
0==a.closest(".itemhdr").length?(d.insertAfter(a),a.parent().fitVids(),jQuery("<br/>").insertAfter(a)):(f=a.closest(".itemhdr").next(),f.prepend(d),f.fitVids());a.text(" [-]").attr("title",_("Hide video")).attr("aria-label",_("Hide embedded video"));a.prev().attr("data-base")&&(d=a.prev().attr("data-base").split("-"),recclick(d[0],d[1],b,a.prev().text()))}}
function setupvideoembeds(a,b){jQuery("<span/>",{text:" [+]",role:"button",title:_("Watch video here"),"aria-label":_("Embed video")+" "+this.textContent,id:"videoembedbtn"+videoembedcounter,click:togglevideoembed,keydown:function(c){13==c.which&&$(this).click()},tabindex:0,"class":"videoembedbtn"}).insertAfter(b);jQuery(b).addClass("prepped");videoembedcounter++}var fileembedcounter=0;
function setuppreviewembeds(a,b){var c="doc|docx|pdf|xls|xlsx|ppt|pptx|jpg|gif|png|jpeg";window.fetch&&(c+="|heic");b.href.match(new RegExp(".("+c+")($|\\?)","i"))&&(jQuery("<span/>",{text:" [+]",role:"button",title:_("Preview file"),"aria-label":_("Preview file"),id:"fileembedbtn"+fileembedcounter,click:togglefileembed,keydown:function(d){13==d.which&&$(this).click()},tabindex:0,"class":"videoembedbtn"}).insertAfter(b),jQuery(b).addClass("prepped"),fileembedcounter++)}
function supportsPdf(){var a=window.navigator.userAgent;return-1!==a.indexOf("irefox")&&18<parseInt(a.split("rv:")[1].split(".")[0],10)||"undefined"!==typeof navigator.mimeTypes["application/pdf"]?!0:!1}
function togglefileembed(){var a=this.id.substr(12),b=jQuery("#fileiframe"+a);if(0<b.length)"none"==b.css("display")?(b.show(),jQuery(this).text(" [-]"),jQuery(this).attr("title",_("Hide preview")),jQuery(this).attr("aria-label",_("Hide file preview"))):(b.hide(),jQuery(this).text(" [+]"),jQuery(this).attr("title",_("Preview file")),jQuery(this).attr("aria-label",_("Preview file")));else{var c=jQuery(this).prev().attr("href");c.match(/\.(doc|docx|pdf|xls|xlsx|ppt|pptx)($|\?)/i)?(b=c.match(/\.pdf/)&&
supportsPdf()?c:c.match(/\.(doc|docx|xls|xlsx|ppt|pptx)($|\?)/i)?"https://view.officeapps.live.com/op/embed.aspx?src="+encodeURIComponent(c):"https://docs.google.com/gview?embedded=true&url="+encodeURIComponent(c),jQuery("<iframe/>",{id:"fileiframe"+a,width:"90%",height:600,src:b,frameborder:0,allowfullscreen:1}).insertAfter(jQuery(this))):c.match(/\.(heic)($|\?)/i)?(jQuery("<div>",{id:"fileiframe"+a,text:"Converting HEIC file (this may take a while)..."}).insertAfter(jQuery(this)),window.heic2any?
convertheic(c,"fileiframe"+a):jQuery.getScript(imasroot+"/javascript/heic2any.min.js").done(function(){convertheic(c,"fileiframe"+a)})):jQuery("<div>").append(jQuery("<img/>",{id:"fileiframe"+a,src:c}).css("display","block").on("click",rotateimg)).insertAfter(jQuery(this));jQuery("<br/>").insertAfter(jQuery(this));jQuery(this).text(" [-]");jQuery(this).attr("title",_("Hide preview"));jQuery(this).prev().attr("data-base")&&(b=jQuery(this).prev().attr("data-base").split("-"),recclick(b[0],b[1],c,jQuery(this).prev().text()))}}
jQuery(function(){var a;(a=window.location.href.match(/course\.php.*cid=(\d+).*folder=([\d\-]+)/))&&window.sessionStorage.setItem("btf"+a[1],a[2]);jQuery('a[href*="course.php"]').each(function(b,c){if(!c.href.match(/folder=/)&&(a=c.href.match(/cid=(\d+)/))){var d=window.sessionStorage.getItem("btf"+a[1])||"";""!==d&&(c.href+="&folder="+d)}});jQuery("form").each(function(b,c){if(c.hasAttribute("action")&&(a=c.getAttribute("action").match(/cid=(\d+)/))){var d=window.sessionStorage.getItem("btf"+a[1])||
"";""!==d&&c.setAttribute("action",c.getAttribute("action")+"&btf="+d)}})});function convertheic(a,b){fetch(a).then(function(c){return c.blob()}).then(function(c){return heic2any({blob:c})}).then(function(c){c=URL.createObjectURL(c);document.getElementById(b).innerHTML='<img src="'+c+'" onclick="rotateimg(this)">'})["catch"](function(c){console.log(c)})}
function addNoopener(a,b){!b.rel&&b.target&&b.host!==window.location.host&&b.setAttribute("rel","noopener noreferrer");b.target&&0==jQuery(b).find(".openext").length&&jQuery(b).append('<span class="sr-only openext">Opens externally</span>')}function addBlankTarget(a,b){b.host!==window.location.host&&b.setAttribute("target","_blank")}function uniqid(a){return(a||"")+"_"+Math.random().toString(36).substr(2,9)}
function setariastatus(a){var b=document.getElementById("ariastatus");b||(b=$("<div>",{id:"ariastatus",role:"status","class":"sr-only","aria-live":"polite"}),$("body").append(b),b=b[0]);b.innerHTML=a}
function addmultiselect(a,b){var c=jQuery(a).parent(),d=jQuery("#"+b).val(),f=jQuery("#"+b+" option[value="+d+"]").prop("disabled",!0).html();"null"!=d&&c.append('<div class="multiselitem"><span class="right"><a href="#" onclick="removemultiselect(this);return false;">Remove</a></span><input type="hidden" name="'+b+'[]" value="'+d+'"/>'+f+"</div>");jQuery("#"+b).val("null")}
function removemultiselect(a){a=jQuery(a).parent().parent();var b=a.find("input").val();a.parent().find("option[value="+b+"]").prop("disabled",!1);a.remove()}function hidefromcourselist(a,b,c){confirm("Are you SURE you want to hide this course from your course list?")&&jQuery.ajax({type:"GET",url:imasroot+"/admin/hidefromcourselist.php?tohide="+b+"&type="+c}).done(function(d){"OK"==d&&(jQuery(a).closest("ul.courselist > li").slideUp(),jQuery("#unhidelink"+c).show())});return!1}
function removeSelfAsCoteacher(a,b,c,d){c=c||"ul.courselist > li";d=d||null;confirm("Are you SURE you want to remove yourself as a co-teacher on this course?")&&jQuery.ajax({type:"POST",url:imasroot+"/admin/actions.php",data:{action:"removeself",id:b,uid:d}}).done(function(f){"OK"==f&&jQuery(a).closest(c).slideUp()});return!1}
function rotateimg(a){a.hasOwnProperty("target")&&(a=a.target);var b=$(a).data("rotation")?($(a).data("rotation")+90)%360:90;$(a).parent().css("height","auto");var c=$(a).parent().width();$(a).data("rotation",b).css({transform:"rotate("+b+"deg)"});if(90==b%180){$(a).css("transform-origin","0 0").css("max-width","none");var d=a.getBoundingClientRect();c=d.width>c?.95*c/d.width:1;90==b?$(a).data("rotation",b).css({transform:"rotate("+b+"deg) scale("+c+") translateY("+-d.width+"px) "}):$(a).data("rotation",
b).css({transform:"rotate("+b+"deg) scale("+c+") translateX("+-d.height+"px) "});d=a.getBoundingClientRect();$(a).parent().css("height",d.height)}else $(a).css("transform-origin","").css("max-width","80%"),$(a).parent().css("height","")}function sendLTIresizemsg(){var a=Math.max(document.body.scrollHeight,document.body.offsetHeight)+100;window.parent!=window.self&&parent.postMessage(JSON.stringify({subject:"lti.frameResize",height:a}),"*")}
jQuery(document).ready(function(a){a(window).on("message",function(b){if("string"==typeof b.originalEvent.data&&b.originalEvent.data.match(/lti\.frameResize/)){var c=JSON.parse(b.originalEvent.data);if("frame_id"in c)a("#"+c.frame_id).height(c.height);else if("iframe_resize_id"in c)a("#"+c.iframe_resize_id).height(c.height);else for(var d=document.getElementsByTagName("iframe"),f=0;f<d.length;f++)if(d[f].contentWindow===b.originalEvent.source&&!d[f].hasAttribute("data-noresize")){a(d[f]).height(c.height);
break}}else"string"==typeof b.originalEvent.data&&b.originalEvent.data.match(/\[iFrameSizer\]/)?(c=b.originalEvent.data.substr(13).split(":"),a("#"+c[0]).height(c[1])):"string"==typeof b.originalEvent.data&&b.originalEvent.data.match(/imathas\.update/)&&(c=JSON.parse(b.originalEvent.data),"qn"in c?(b=c.qn.replace(/[^\d]/,""),""!=b&&a("#qn"+b).val(c.value).trigger("change")):(b=c.id.replace(/[^\w\-]/,""),a("#"+b).hasClass("allowupdate")&&a("#"+b).val(c.value).trigger("change")))})});
function initlinkmarkup(a){"undefined"!=typeof isImathasAssessment&&$(a).find("a:not([target])").not(".textsegment a, .mce-content-body a").each(addBlankTarget);$(a).find("a").each(setuptracklinks).each(addNoopener);$(a).find('a[href*="youtu"]').not(".textsegment a,.mce-content-body a,.prepped").each(setupvideoembeds);$(a).find('a[href*="vimeo"]').not(".textsegment a,.mce-content-body a,.prepped").each(setupvideoembeds);$(a).find("a.attach").not(".textsegment a,.mce-content-body a").not(".prepped").each(setuppreviewembeds);
setupToggler(a);setupToggler2(a);$(a).fitVids();resizeResponsiveIframes(a,!0)}function resizeResponsiveIframes(a,b){b&&jQuery(a).find("iframe.scaleresponsive").wrap(jQuery("<div>",{css:{overflow:"hidden"}}));jQuery(a).find("iframe.scaleresponsive").each(function(c,d){var f=d.parentNode,e=Math.min(1,f.offsetWidth/parseInt(d.width||d.style.width));d.style.transform="scale("+e+")";f.style.height=e*parseInt(d.height||d.style.height)+3+"px"})}
jQuery(document).ready(function(a){initlinkmarkup("body");a(window).on("resize",function(){resizeResponsiveIframes("body")})});jQuery.fn.isolatedScroll=function(){this.bind("mousewheel DOMMouseScroll",function(a){var b=a.wheelDelta||a.originalEvent&&a.originalEvent.wheelDelta||-a.detail,c=0<=this.scrollTop+jQuery(this).outerHeight()-this.scrollHeight,d=0>=this.scrollTop;(0>b&&c||0<b&&d)&&a.preventDefault()});return this};
jQuery(document).ready(function(a){for(var b=a(".fixedonscroll"),c=[],d=0;d<b.length;d++)c[d]=a(b[d]).offset().top,a(b[d]).height()>a(window).height()&&(c[d]=-1);0<b.length&&a(window).scroll(function(){for(var f=a(window).scrollTop(),e=0;e<b.length;e++)f>c[e]&&0<c[e]?a(b[e]).css("position","fixed").css("top","5px").attr("data-fixed",!0):a(b[e]).css("position","static").attr("data-fixed",!1)})});
function _(a){var b="undefined"!=typeof i18njs&&i18njs[a]?i18njs[a]:a;if(1<arguments.length)for(var c=1;c<arguments.length;c++)b=b.replace("$"+c,arguments[c]);return b}function randID(){return"_"+Math.random().toString(36).substr(2,9)}
function setupToggler(a){$(a).find("*[data-toggler]:not(.togglerinit)").each(function(){var b=$(this).attr("id")||randID();"IFRAME"===$(this).prop("tagName")&&$(this).css("display","block");var c="block"==$(this).css("display"),d=$(this).attr("data-toggler"),f=$(this).attr("data-toggler-hide")||d,e=$("<button>",{id:"togbtn"+b,type:"button",text:d,"aria-controls":b});$(this).hide().attr("id",b).addClass("togglerinit").before(e);e.attr("aria-expanded",!1).attr("tabindex",0).css("cursor","pointer").on("click keydown",
function(g){if("click"==g.type||13==g.which)g=$("#"+$(this).attr("aria-controls")),"true"==$(this).attr("aria-expanded")?($(this).attr("aria-expanded",!1).text(d),c?g.slideUp(300):g.hide()):($(this).attr("aria-expanded",!0).text(f),c?g.slideDown(300):g.show())})})}
function setupToggler2(a){$(a).find(".togglecontrol:not(.togglerinit)").each(function(){$(this).addClass("togglerinit").attr("aria-expanded",!1).on("click keydown",function(b){if("click"==b.type||13==b.which)return b=$("#"+$(this).attr("aria-controls")),"true"==$(this).attr("aria-expanded")?($(this).attr("aria-expanded",!1),b.hide()):($(this).attr("aria-expanded",!0),b.show()),!1})})}function groupToggleAll(a){$(".grouptoggle").attr("aria-expanded",1==a?!1:!0).trigger("click")}
jQuery(document).ready(function(a){a(".grouptoggle").each(function(){var b=randID(),c=a(this).next(".blockitems"),d=c.hasClass("hidden");d?c.hide().removeClass("hidden"):c.show();c.attr("id","bi"+b);a(this).attr("id",b).attr("aria-controls","bi"+b).attr("aria-expanded",!d).attr("tabindex",0).css("cursor","pointer").on("click keydown",function(f){if("click"==f.type||13==f.which)"true"==a(this).attr("aria-expanded")?(a(this).attr("aria-expanded",!1),a(this).children("img").attr("src","../img/expand.gif"),
a(this).next(".blockitems").slideUp()):(a(this).attr("aria-expanded",!0),a(this).children("img").attr("src","../img/collapse.gif"),a(this).next(".blockitems").slideDown())})});a(".grouptoggle img").attr("alt","expand/collapse")});
function initFileAlt(a){var b=jQuery(a).next().find(".filealt-label"),c=b.attr("data-def")||b.html();jQuery(a).off("focus.filealt, blur.filealt, click.filealt, change.filealt").on("focus.filealt",function(d){jQuery(d.target).addClass("has-focus")}).on("blur.filealt",function(d){jQuery(d.target).removeClass("has-focus")}).on("click.filealt",function(d){b.html(c)}).on("change.filealt",function(d){if(d=d.target.value.split(/(\\|\/)/g).pop())1024E4<this.files[0].size?(alert(_("This file is too large - maximum size is 10MB")),
$(this).val("")):b.html(d)})}jQuery("input.filealt").each(function(a,b){initFileAlt(b)});
(function(a){a.fn.fitVids=function(){return this.each(function(){a(this).find("iframe[src*='player.vimeo.com'],iframe[src*='youtube.com'],iframe[src*='youtube-nocookie.com']").each(function(){var b=a(this);if(0<b.closest(".textsegment").length||0<b.closest(".fluid-width-video-wrapper").length)return!0;b.parentsUntil(".intro","table").each(function(){a(this).css("width","100%")});var c=b.attr("height")&&!isNaN(parseInt(b.attr("height"),10))?parseInt(b.attr("height"),10):b.height(),d=isNaN(parseInt(b.attr("width"),
10))?b.width():parseInt(b.attr("width"),10);c/=d;b.attr("id")||b.attr("id","fitvid"+Math.floor(999999*Math.random()));b.wrap('<div class="fluid-width-video-wrapper"></div>').parent(".fluid-width-video-wrapper").css("padding-top",100*c+"%").wrap('<div class="video-wrapper-wrapper"></div>').parent(".video-wrapper-wrapper").css("max-width",d+"px");b.removeAttr("height").removeAttr("width").css("height","").css("width","")})})}})(window.jQuery||window.Zepto);
function setAltSelectors(a,b){$(".alts."+a).parents(".altWrap").find(".altContentOn").removeClass("altContentOn").addClass("altContentOff");$(".alts."+a).parents(".altWrap").find("."+b).addClass("altContentOn").removeClass("altContentOff");$("select.alts."+a).val(a+":"+b);var c=new Date;c.setDate(c.getDate()+365);document.cookie="alt_store_"+a+"="+escape(b)+";expires="+c.toGMTString()+";path=/"}
jQuery(document).ready(function(a){a(".alts").on("change",function(){var b=this.value.split(":");1<b.length&&setAltSelectors(b[0],b[1])}).each(function(b,c){var d=c.value.split(":");null!=(co=readCookie("alt_store_"+d[0]))?setAltSelectors(d[0],co):a(c).hasClass("setDefault")&&setAltSelectors(d[0],d[1])});a(document).on("keydown",function(b){8!==b.which||a(b.target).is("input[type='text']:not([readonly]),input[type='number']:not([readonly]),input:not([type]):not([readonly]),input[type='password']:not([readonly]),input[type='url']:not([readonly]),input[type='email']:not([readonly]), textarea, [contenteditable='true']")||
b.preventDefault()});a("div.breadcrumb").attr("role","navigation").attr("aria-label",_("Navigation breadcrumbs"));a("div.cpmid,div.cp").attr("role","group").attr("aria-label",_("Control link group"));a("#centercontent").length&&(a("#centercontent").attr("role","main"),a(".midwrapper").removeAttr("role"))});
jQuery(document).ready(function(a){function b(c){var d=a("#headermobilemenulist");"true"==d.attr("aria-hidden")?(a("#headermobilemenulist").slideDown(50,function(){a("#headermobilemenulist").addClass("menuexpanded").removeAttr("style");d.attr("aria-hidden",!1);a("#topnavmenu").attr("aria-expanded",!0)}),a("#navlist").slideDown(100,function(){a("#navlist").addClass("menuexpanded").removeAttr("style")})):(a("#navlist").slideUp(100,function(){a("#navlist").removeClass("menuexpanded").removeAttr("style")}),
a("#headermobilemenulist").slideUp(50,function(){a("#headermobilemenulist").removeClass("menuexpanded").removeAttr("style");d.attr("aria-hidden",!0);a("#topnavmenu").attr("aria-expanded",!1)}));c.preventDefault()}a("#topnavmenu").on("click",b).on("keydown",function(c){13!==c.which&&32!=c.which||b(c)})});var sagecellcounter=0;
function initSageCell(a){jQuery(a).find(".converttosagecell").each(function(){var b=jQuery(this);if(b.is("pre")){var c=this;var d=jQuery(c).html().replace(/<br\s*\/?>/g,"\n").replace(/<\/?[a-zA-Z][^>]*>/g,"").replace(/&lt;/g,"<").replace(/&gt;/g,">")}else if(c=b.find("textarea"),0==c.length||""==jQuery(c[0]).val())if(0<b.find("pre").length)d=b.find("pre").html().replace(/<br\s*\/?>/g,"\n").replace(/<\/?[a-zA-Z][^>]*>/g,"").replace(/\n\n/g,"\n").replace(/&lt;/g,"<").replace(/&gt;/g,">"),c=0==c.length?
b.find("pre")[0]:c[0];else return!1;else d=jQuery(c[0]).val(),c=c[0];if(m=d.match(/^\s+/)){b=m[0].length;var f=new RegExp("\\n\\s{"+b+"}","g");d=d.substr(b).replace(f,"\n").replace(/\s+$/,"")}b="sagecell-"+sagecellcounter;sagecellcounter++;f=imasroot+"/assessment/libs/sagecellframe.html?frame_id="+b;f+="&code="+encodeURIComponent(d);"undefined"!=typeof jQuery(c).attr("id")&&(f+="&update_id="+jQuery(c).attr("id"));f+="&evallabel="+encodeURIComponent(_("Evaluate"));jQuery(c).addClass("allowupdate").hide().after(jQuery("<iframe/>",
{id:b,"class":"sagecellframe",style:"border:0",width:"100%",height:100,src:f}))})}jQuery(function(){initSageCell("body")});
function setActiveTab(a){jQuery(a).closest(".tabwrap").find("li.active").removeClass("active");jQuery(a).closest(".tablist").find("a[role=tab]").attr("aria-selected",!1);jQuery(a).attr("aria-selected",!0);jQuery(a).parent().addClass("active");jQuery(a).closest(".tabwrap").find(".tabpanel").hide().attr("aria-hidden",!0);var b=a.getAttribute("aria-controls");jQuery(a).closest(".tabwrap").find("#"+b).show().attr("aria-hidden",!1)}
+function(a){function b(e){var g=e.attr("data-target");g||(g=(g=e.attr("href"))&&/#[A-Za-z]/.test(g)&&g.replace(/.*(?=#[^\s]*$)/,""));return(g=g&&a(g))&&g.length?g:e.parent()}function c(e){e&&3===e.which||(a(".dropdown-backdrop").remove(),a('[data-toggle="dropdown"]').each(function(){var g=a(this),h=b(g),l={relatedTarget:this};!h.hasClass("open")||e&&"click"==e.type&&/input|textarea/i.test(e.target.tagName)&&a.contains(h[0],e.target)||(h.trigger(e=a.Event("hide.bs.dropdown",l)),e.isDefaultPrevented()||
(g.attr("aria-expanded","false"),h.removeClass("open").trigger("hidden.bs.dropdown",l)))}))}var d=function(e){a(e).on("click.bs.dropdown",this.toggle);b(a(e)).find("[role=menu].dropdown-menu li:not(.disabled) a").attr("role","menuitem")};d.VERSION="3.3.5";d.prototype.toggle=function(e){var g=a(this);if(!g.is(".disabled, :disabled")){var h=b(g);e=h.hasClass("open");c();if(!e){if("ontouchstart"in document.documentElement&&!h.closest(".navbar-nav").length)a(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(a(this)).on("click",
c);var l={relatedTarget:this};h.trigger(e=a.Event("show.bs.dropdown",l));if(e.isDefaultPrevented())return;g.trigger("focus").attr("aria-expanded","true");h.toggleClass("open").trigger("shown.bs.dropdown",l)}return!1}};d.prototype.keydown=function(e){if(/(38|40|27|32)/.test(e.which)&&!/input|textarea/i.test(e.target.tagName)){var g=a(this);e.preventDefault();e.stopPropagation();if(!g.is(".disabled, :disabled")){var h=b(g),l=h.hasClass("open");if(!l&&27!=e.which||l&&27==e.which)return 27==e.which&&
h.find('[data-toggle="dropdown"]').trigger("focus"),g.trigger("click");g=h.find(".dropdown-menu li:not(.disabled):visible a");g.length&&(h=g.index(e.target),38==e.which&&0<h&&h--,40==e.which&&h<g.length-1&&h++,~h||(h=0),g.eq(h).trigger("focus"))}}};var f=a.fn.dropdown;a.fn.dropdown=function(e){return this.each(function(){var g=a(this),h=g.data("bs.dropdown");h||g.data("bs.dropdown",h=new d(this));"string"==typeof e&&h[e].call(g)})};a.fn.dropdown.Constructor=d;a.fn.dropdown.noConflict=function(){a.fn.dropdown=
f;return this};a(document).on("click.bs.dropdown.data-api",c).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",'[data-toggle="dropdown"]',d.prototype.toggle).on("keydown.bs.dropdown.data-api",'[data-toggle="dropdown"]',d.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",d.prototype.keydown);a(function(){a("[role=menu].dropdown-menu li:not(.disabled) a").attr("role","menuitem")})}(jQuery);

var pi=Math.PI,ln=Math.log,e=Math.E,arcsin=Math.asin,arccos=Math.acos,arctan=Math.atan,sec=function(a){return 1/Math.cos(a)},csc=function(a){return 1/Math.sin(a)},cot=function(a){return 1/Math.tan(a)},arcsec=function(a){return arccos(1/a)},arccsc=function(a){return arcsin(1/a)},arccot=function(a){return arctan(1/a)},sinh=function(a){return(Math.exp(a)-Math.exp(-a))/2},cosh=function(a){return(Math.exp(a)+Math.exp(-a))/2},tanh=function(a){return(Math.exp(a)-Math.exp(-a))/(Math.exp(a)+Math.exp(-a))},
sech=function(a){return 1/cosh(a)},csch=function(a){return 1/sinh(a)},coth=function(a){return 1/tanh(a)},arcsinh=function(a){return ln(a+Math.sqrt(a*a+1))},arccosh=function(a){return ln(a+Math.sqrt(a*a-1))},arctanh=function(a){return ln((1+a)/(1-a))/2};sech=function(a){return 1/cosh(a)};csch=function(a){return 1/sinh(a)};coth=function(a){return 1/tanh(a)};
var arcsech=function(a){return arccosh(1/a)},arccsch=function(a){return arcsinh(1/a)},arccoth=function(a){return arctanh(1/a)},sign=function(a){return 0==a?0:0>a?-1:1},logten=function(a){return Math.LOG10E*Math.log(a)},sinn=function(a,d){return Math.pow(Math.sin(d),a)},cosn=function(a,d){return Math.pow(Math.cos(d),a)},tann=function(a,d){return Math.pow(Math.tan(d),a)},cscn=function(a,d){return 1/Math.pow(Math.sin(d),a)},secn=function(a,d){return 1/Math.pow(Math.cos(d),a)},cotn=function(a,d){return 1/
Math.pow(Math.tan(d),a)};function factorial(a,d){null==d&&(d=1);for(var g=a-d;0<g;g-=d)a*=g;return 0>a?NaN:0==a?1:a}function C(a,d){for(var g=1,l=0;l<d;l++)g*=(a-l)/(d-l);return g}function matchtolower(a){return a.toLowerCase()}function nthroot(a,d){return safepow(d,1/a)}function nthlogten(a,d){return Math.log(d)/Math.log(a)}var funcstoindexarr="sinh cosh tanh sech csch coth sqrt ln log exp sin cos tan sec csc cot abs root arcsin arccos arctan arcsec arccsc arccot arcsinh arccosh arctanh arcsech arccsch arccoth".split(" ");
function functoindex(a){for(var d=0;d<funcstoindexarr.length;d++)if(funcstoindexarr[d]==a)return"@"+d+"@"}function indextofunc(a,d){return funcstoindexarr[d]}function safepow(a,d){if(0>a&&Math.floor(d)!=d){for(var g=3;50>g;g+=2)if(1E-6>Math.abs(Math.round(g*d)-g*d))return 0==Math.round(g*d)%2?Math.pow(Math.abs(a),d):-1*Math.pow(Math.abs(a),d);return Math.sqrt(-1)}return Math.pow(a,d)}
function mathjs(a,d){a=a.replace("[","(");a=a.replace("]",")");a=a.replace(/root\s*(\d+)/,"root($1)");a=a.replace(/\|(.*?)\|/g,"abs($1)");a=a.replace(/arc(sin|cos|tan|sec|csc|cot|sinh|cosh|tanh|sech|csch|coth)/gi,"$1^-1");a=a.replace(/(Sin|Cos|Tan|Sec|Csc|Cot|Arc|Abs|Log|Exp|Ln|Sqrt)/gi,matchtolower);a=a.replace(/(sinh|cosh|tanh|sech|csch|coth|sqrt|ln|log|exp|sin|cos|tan|sec|csc|cot|abs|root)/g,functoindex);if(null!=d&&""!=d){var g=d.split("|");g.push("pi");g.sort(function(p,m){return m.length-p.length});
d=g.join("|");for(var l=[],h=0;h<g.length;h++){l[h]=!1;for(var c=0;c<g.length;c++)if(h!=c&&g[c].toLowerCase()==g[h].toLowerCase()&&g[c]!=g[h]){l[h]=!0;break}}a=a.replace(new RegExp("("+d+")","gi"),function(p,m){for(var n=0;n<g.length;n++)if(g[n]==m||!l[n]&&g[n].toLowerCase()==m.toLowerCase())return"(@v"+n+"@)"})}else a=a.replace(/pi/g,"(pi)");a=a.replace(/([0-9])E([\-0-9])/g,"$1(EE)$2");a=a.replace(/e/g,"(E)");a=a.replace(/@(\d+)@/g,indextofunc);a=a.replace(/log_([a-zA-Z\d\.]+)\s*\(/g,"nthlog($1,");
a=a.replace(/log_\(([a-zA-Z\/\d\.]+)\)\s*\(/g,"nthlog(($1),");a=a.replace(/log_(\(@v\d+@\))\s*\(/g,"nthlog($1,");a=a.replace(/log/g,"logten");a=a.replace(/(sin|cos|tan|sec|csc|cot|sinh|cosh|tanh|sech|csch|coth)\^(-1|\(-1\))/g,"arc$1");a=a.replace(/(sin|cos|tan|sec|csc|cot)\^(\d+)\s*\(/g,"$1n($2,");a=a.replace(/(sin|cos|tan|sec|csc|cot)\^\((\d+)\)\s*\(/g,"$1n($2,");a=a.replace(/root\s*\((\d+)\)\s*\(/g,"nthroot($1,");a=a.replace(/([0-9])\s+([0-9])/g,"$1*$2");a=a.replace(/#/g,"");a=a.replace(/\s/g,"");
null!=d&&""!=d&&(a=a.replace(/@v(\d+)@/g,function(p,m){return g[m]}));a=a.replace(/([0-9])([\(a-zA-Z])/g,"$1*$2");a=a.replace(/(!)([0-9\(a-zA-Z])/g,"$1*$2");a=a.replace(/\)([\(0-9a-zA-Z]|\.\d+)/g,")*$1");a=a.replace(/([0-9])\*\(EE\)\*?([\-0-9])/g,"$1e$2");for(var f,b,k;-1!=(h=a.indexOf("!"));){if(0==h)return"Error: missing argument";c=h-1;b=a.charAt(c);if("0"<=b&&"9">=b){for(c--;0<=c&&"0"<=(b=a.charAt(c))&&"9">=b;)c--;if("."==b)for(c--;0<=c&&"0"<=(b=a.charAt(c))&&"9">=b;)c--}else if(")"==b){k=1;for(c--;0<=
c&&0<k;)b=a.charAt(c),"("==b?k--:")"==b&&k++,c--;for(;0<=c&&("a"<=(b=a.charAt(c))&&"z">=b||"A"<=b&&"Z">=b);)c--}else if("a"<=b&&"z">=b||"A"<=b&&"Z">=b)for(c--;0<=c&&("a"<=(b=a.charAt(c))&&"z">=b||"A"<=b&&"Z">=b);)c--;else return"Error: incorrect syntax in "+a+" at position "+c;a=a.slice(0,c+1)+"factorial("+a.slice(c+1,h)+")"+a.slice(h+1)}for(;-1!=(h=a.lastIndexOf("^"));){if(0==h)return"Error: missing argument";c=h-1;b=a.charAt(c);if("0"<=b&&"9">=b){for(c--;0<=c&&"0"<=(b=a.charAt(c))&&"9">=b;)c--;
if("."==b)for(c--;0<=c&&"0"<=(b=a.charAt(c))&&"9">=b;)c--}else if(")"==b){k=1;for(c--;0<=c&&0<k;)b=a.charAt(c),"("==b?k--:")"==b&&k++,c--;for(;0<=c&&("a"<=(b=a.charAt(c))&&"z">=b||"A"<=b&&"Z">=b);)c--}else if("a"<=b&&"z">=b||"A"<=b&&"Z">=b)for(c--;0<=c&&("a"<=(b=a.charAt(c))&&"z">=b||"A"<=b&&"Z">=b);)c--;else return"Error: incorrect syntax in "+a+" at position "+c;if(h==a.length-1)return"Error: missing argument";f=h+1;b=a.charAt(f);nch=a.charAt(f+1);if("0"<=b&&"9">=b||"-"==b&&"("!=nch||"."==b){for(f++;f<
a.length&&"0"<=(b=a.charAt(f))&&"9">=b;)f++;if("."==b)for(f++;f<a.length&&"0"<=(b=a.charAt(f))&&"9">=b;)f++}else if("("==b||"-"==b&&"("==nch)for("-"==b&&f++,k=1,f++;f<a.length&&0<k;)b=a.charAt(f),"("==b?k++:")"==b&&k--,f++;else if("a"<=b&&"z">=b||"A"<=b&&"Z">=b){for(f++;f<a.length&&("a"<=(b=a.charAt(f))&&"z">=b||"A"<=b&&"Z">=b);)f++;if("("==b&&a.slice(h+1,f).match(/^(sinn|cosn|tann|secn|cscn|cotn|sin|cos|tan|sec|csc|cot|logten|nthlogten|log|ln|exp|arcsin|arccos|arctan|arcsec|arccsc|arccot|sinh|cosh|tanh|sech|csch|coth|arcsinh|arccosh|arctanh|arcsech|arccsch|arccoth|sqrt|abs|nthroot|factorial|safepow)$/))for(k=
1,f++;f<a.length&&0<k;)b=a.charAt(f),"("==b?k++:")"==b&&k--,f++}else return"Error: incorrect syntax in "+a+" at position "+f;a=a.slice(0,c+1)+"safepow("+a.slice(c+1,h)+","+a.slice(h+1,f)+")"+a.slice(f)}return a};

function updateeeddpos(){}function updateehpos(){}var onlyAscii=/^[\u0000-\u007f]*$/,LivePreviews=[];
function setupLivePreview(a){LivePreviews.hasOwnProperty(a)||("MathJax"==mathRenderer||"Katex"==mathRenderer?(LivePreviews[a]={delay:"MathJax"==mathRenderer?100:0,finaldelay:1E3,preview:null,buffer:null,timeout:null,finaltimeout:null,mjRunning:!1,mjPending:!1,oldText:null,Init:function(){$("#p"+a).css("positive","relative").append('<span id="lpbuf1'+a+'" style="visibility:hidden;position:absolute;"></span>').append('<span id="lpbuf2'+a+'" style="visibility:hidden;position:absolute;"></span>');this.preview=
document.getElementById("lpbuf1"+a);this.buffer=document.getElementById("lpbuf2"+a)},SwapBuffers:function(){var b=this.preview,d=this.buffer;this.buffer=b;this.preview=d;b.style.visibility="hidden";b.style.position="absolute";d.style.position="";d.style.visibility=""},Update:function(b){this.timeout&&clearTimeout(this.timeout);this.finaltimeout&&clearTimeout(this.finaltimeout);this.timeout=setTimeout(this.callback,this.delay);this.finaltimeout=setTimeout(this.DoFinalPreview,this.finaldelay)},RenderNow:function(b){this.buffer.innerHTML=
this.oldtext=b;this.mjRunning=!0;this.RenderBuffer()},RenderBuffer:function(){"MathJax"==mathRenderer?MathJax.Hub.Queue(["Typeset",MathJax.Hub,this.buffer],["PreviewDone",this]):"Katex"==mathRenderer&&(renderMathInElement(this.buffer),"undefined"!=typeof MathJax&&MathJax.version&&0<$(this.buffer).children(".mj").length?MathJax.Hub.Queue(["PreviewDone",this]):this.PreviewDone())},DoFinalPreview:function(){$("#pbtn"+a).trigger("click")},preformat:function(b){b=normalizemathunicode(b);if(intcalctoproc.hasOwnProperty(a))calcformat[a].match(/inequality/)?
(b=b.replace(/<=/g," le ").replace(/>=/g," ge ").replace(/</g," lt ").replace(/>/g," gt "),b.match(/all\s*real/i)&&(b="text("+b+")")):b=b.replace(/U/g,"uu");else if(vlist.hasOwnProperty(a))b=AMnumfuncPrepVar(a,b)[1];else if(ntupletoproc.hasOwnProperty(a))b=b.replace(/</g,"(:").replace(/>/g,":)");else if(calcformat.hasOwnProperty(a)){var d=calcformat[a];-1==d.indexOf("list")&&-1==d.indexOf("set")&&(b=b.replace(/(\d)\s*,\s*(?=\d{3}\b)/g,"$1"));-1!=d.indexOf("scinot")&&(b=b.replace(/(x|X|\u00D7)/,"xx"))}return b=
b.replace(/[^\u0000-\u007f]/g,"?")},CreatePreview:function(){this.timeout=null;if(!this.mjPending){var b=null==document.getElementById("tc"+a)?document.getElementById("qn"+a).value:document.getElementById("tc"+a).value;b!==this.oldtext&&(this.mjRunning?(this.mjPending=!0,MathJax.Hub.Queue(["CreatePreview",this])):(this.oldtext=b,this.buffer.innerHTML="`"+this.preformat(b)+"`",this.mjRunning=!0,this.RenderBuffer()))}},PreviewDone:function(){this.mjRunning=this.mjPending=!1;this.SwapBuffers();updateeeddpos();
updateehpos()}},"MathJax"==mathRenderer?(LivePreviews[a].callback=MathJax.Callback(["CreatePreview",LivePreviews[a]]),LivePreviews[a].callback.autoReset=!0):LivePreviews[a].callback=function(){LivePreviews[a].CreatePreview()},LivePreviews[a].Init()):LivePreviews[a]={finaldelay:1E3,finaltimeout:null,Update:function(b){this.finaltimeout&&clearTimeout(this.finaltimeout);this.finaltimeout=setTimeout(this.DoFinalPreview,this.finaldelay)},RenderNow:function(b){var d=document.getElementById("p"+a);d.innerHTML=
b;rendermathnode(d)},DoFinalPreview:function(){$("#pbtn"+a).trigger("click")}})}function updateLivePreview(a){a=a.id.substr(2);setupLivePreview(a);LivePreviews[a].Update()}
function normalizemathunicode(a){a=a.replace(/[\x00-\x09\x0B\x0C\x0E-\x1F\x7F]/g,"");a=a.replace(/\u2013|\u2014|\u2015|\u2212/g,"-");a=a.replace(/\u2044|\u2215/g,"/");a=a.replace(/\u221e/g,"oo").replace(/\u2264/g,"<=").replace(/\u2265/g,">=").replace(/\u222a/g,"U");a=a.replace(/\u00b1/g,"+-").replace(/\u00f7/g,"/").replace(/\u00b7|\u2715|\u00d7|\u22c5/g,"*");a=a.replace(/\u221a/g,"sqrt").replace(/\u221b/g,"root(3)");a=a.replace(/\u00b2/g,"^2").replace(/\u00b3/g,"^3");a=a.replace(/\u2329/g,"<").replace(/\u232a/g,
">");a=a.replace(/\u2080/g,"_0").replace(/\u2081/g,"_1").replace(/\u2082/g,"_2").replace(/\u2083/g,"_3");a=a.replace(/\bOO\b/i,"oo");a=a.replace(/\u03b8/,"theta").replace(/\u03d5/,"phi").replace(/\u03c6/,"phi").replace(/\u03c0/,"pi").replace(/\u03c3/,"sigma").replace(/\u03bc/,"mu");a=a.replace(/\u03b1/,"alpha").replace(/\u03b2/,"beta").replace(/\u03b3/,"gamma").replace(/\u03b4/,"delta").replace(/\u03b5/,"epsilon").replace(/\u03ba/,"kappa");a=a.replace(/\u03bb/,"lambda").replace(/\u03c1/,"rho").replace(/\u03c4/,
"tau").replace(/\u03c7/,"chi").replace(/\u03c9/,"omega");return a=a.replace(/\u03a9/,"Omega").replace(/\u0393/,"Gamma").replace(/\u03a6/,"Phi").replace(/\u0394/,"Delta").replace(/\u03a3/,"Sigma")}function wrapAMnotice(a){return'<span class="AMHnotice">'+a+"</span>"}
function calculate(a,b,d){var c=document.getElementById(a).value;c=normalizemathunicode(c);c=c.replace(/=/,"");if(-1!=d.indexOf("list"))var e=c.split(/,/);else-1!=d.indexOf("set")?e=c.replace(/[\{\}]/g,"").split(/,/):(e=[],e[0]=c);for(c=0;c<e.length;c++){str=e[c];str=str.replace(/(\d)\s*,\s*(?=\d{3}\b)/g,"$1");var g="";if(str.match(/DNE/i))str=str.toUpperCase();else if(str.match(/oo$/)||str.match(/oo\W/))str="`"+str+"`";else{g+=singlevalsyntaxcheck(str,d);str.match(/,/)&&(g+=_("Invalid use of a comma."));
-1!=d.indexOf("allowxtimes")&&(str=str.replace(/(x|X|\u00D7)/,"*"));str=-1!=d.indexOf("mixed")?str.replace(/_/g," "):-1!=d.indexOf("scinot")?str.replace(/(x|X|\u00D7)/,"xx"):str.replace(/^\s+/,"").replace(/\s+$/,"");g+=syntaxcheckexpr(str,d);try{var f=str;f=f.replace(",","*NaN*");f.match(/^\s*[+-]?\s*((\d+(\.\d*)?)|(\.\d+))\s*%\s*$/)&&(f=f.replace(/%/,"")+"/100");-1!=d.indexOf("mixed")&&(f=f.replace(/(\d+)\s+(\d+|\(\d+\))\s*\/\s*(\d+|\(\d+\))/g,"($1+$2/$3)"));-1!=d.indexOf("scinot")&&(f=f.replace("xx",
"*"));var l=scopedmatheval(f)}catch(h){g=_("syntax incomplete")+". "+g,l=NaN}str=str.replace(/[^\u0000-\u007f]/g,"?");isNaN(l)||"Infinity"==l||""===l?""!=str&&(str="`"+str+"` = "+_("undefined")+". "+wrapAMnotice(g)):str=-1==d.indexOf("showval")?"`"+str+"` "+wrapAMnotice(g):"`"+str+" =` "+(1E-15>Math.abs(l)?0:l)+". "+wrapAMnotice(g)}e[c]=str+" "}c=e.join(", ");-1!=d.indexOf("set")&&(c=document.getElementById(a).value.match(/^\s*{.*?}\s*$/)?"{"+c+"}":c+wrapAMnotice(_("syntax error: this answer must be in set notation, a list wrapped in braces like {1,2,3}")));
a=b.substr(1);setupLivePreview(a);LivePreviews[a].RenderNow(c)}
function ineqtointerval(a){a=a.replace(/(\d)\s*,\s*(?=\d{3}\b)/g,"$1");a=a.split(/or/);for(i=0;i<a.length;i++){str=a[i];var b="";(pat=str.match(/^([^<]+)\s*(<=?)\s*([a-zA-Z]\(\s*[a-zA-Z]\s*\)|[a-zA-Z]+)\s*(<=?)([^<]+)$/))?(b="<="==pat[2]?b+"[":b+"(",b+=pat[1]+","+pat[5],b="<="==pat[4]?b+"]":b+")"):(pat=str.match(/^([^>]+)\s*(>=?)\s*([a-zA-Z]\(\s*[a-zA-Z]\s*\)|[a-zA-Z]+)\s*(>=?)([^>]+)$/))?(b=">="==pat[4]?b+"[":b+"(",b+=pat[5]+","+pat[1],b=">="==pat[2]?b+"]":b+")"):(pat=str.match(/^([^><]+)\s*([><]=?)\s*([a-zA-Z]\(\s*[a-zA-Z]\s*\)|[a-zA-Z]+)\s*$/))?
">"==pat[2]?b="(-oo,"+pat[1]+")":">="==pat[2]?b="(-oo,"+pat[1]+"]":"<"==pat[2]?b="("+pat[1]+",oo)":"<="==pat[2]&&(b="["+pat[1]+",oo)"):(pat=str.match(/^\s*([a-zA-Z]\(\s*[a-zA-Z]\s*\)|[a-zA-Z]+)\s*([><]=?)\s*([^><]+)$/))?"<"==pat[2]?b="(-oo,"+pat[3]+")":"<="==pat[2]?b="(-oo,"+pat[3]+"]":">"==pat[2]?b="("+pat[3]+",oo)":">="==pat[2]&&(b="["+pat[3]+",oo)"):b=str.match(/all\s*real/i)?"(-oo,oo)":"";a[i]=b}return b=a.join("U")}
function intcalculate(a,b,d){a=document.getElementById(a).value;a=-1!=d.indexOf("mixed")?a.replace(/_/g," ").replace(/^\s+/,"").replace(/\s+$/,""):a.replace(/^\s+/,"").replace(/\s+$/,"");a=normalizemathunicode(a);if(a.match(/DNE/i))a=a.toUpperCase();else if(""==a.replace(/\s+/g,""))a=_("no answer given");else{var c=[],e=[];if(-1!=d.indexOf("inequality")){var g=a=a.replace(/or/g," or ");a=ineqtointerval(a);var f=str.match(/\b([a-zA-Z]\(\s*[a-zA-Z]\s*\)|[a-zA-Z]+\b)/),l=str.match(/([a-zA-Z]\(\s*[a-zA-Z]\s*\)|[a-zA-Z]+)/);
f=null!=f?f[1]:null!=l?l[1]:""}else g=a;if(-1!=d.indexOf("list")){var h=0;l=[];for(var m=1;m<a.length-1;m++)","!=a.charAt(m)||")"!=a.charAt(m-1)&&"]"!=a.charAt(m-1)||"("!=a.charAt(m+1)&&"["!=a.charAt(m+1)||(l.push(a.substring(h,m)),h=m+1);l.push(a.substring(h))}else l=a.split(/\s*U\s*/i);h=!0;m="";for(i=0;i<l.length;i++){str=l[i];sm=str.charAt(0);em=str.charAt(str.length-1);vals=str.substring(1,str.length-1);vals=vals.split(/,/);if(2!=vals.length||"("!=sm&&"["!=sm||")"!=em&&"]"!=em){-1!=d.indexOf("inequality")?
(g=g.replace("<=","le").replace(">=","ge").replace("<","lt").replace(">","gt"),a="`"+g+"`: "+wrapAMnotice(_("invalid inequality notation"))):a="`"+g.replace(/U/g,"uu")+"`: "+wrapAMnotice(_("invalid interval notation"));h=!1;break}for(j=0;2>j;j++)if(vals[j].match(/oo$/)||vals[j].match(/oo\W/))c[j]=vals[j];else{var n="";q=NaN;n+=singlevalsyntaxcheck(vals[j],d);-1!=d.indexOf("mixed")?vals[j]=vals[j].replace(/_/g," ").replace(/^\s+/,"").replace(/\s+$/,""):vals[j]=vals[j].replace(/^\s+/,"").replace(/\s+$/,
"");n+=syntaxcheckexpr(vals[j],d);if(""==n)try{toeval=vals[j];-1!=d.indexOf("mixed")&&(toeval=toeval.replace(/(\d+)\s+(\d+|\(\d+\))\s*\/\s*(\d+|\(\d+\))/g,"($1+$2/$3)"));var q=scopedmatheval(toeval)}catch(p){n=_("syntax incomplete")+". "}isNaN(q)||"Infinity"==q||""===q?c[j]=_("undefined"):(vals[j]=vals[j],c[j]=(1E-15>Math.abs(q)?0:q).toString());""!=n&&(m+=n)}l[i]=sm+vals[0]+","+vals[1]+em;-1!=d.indexOf("inequality")?(c[0].match(/oo/)?c[1].match(/oo/)?e[i]="RR":e[i]=f+("]"==em?"le":"lt")+c[1]:c[1].match(/oo/)?
e[i]=f+("["==sm?"ge":"gt")+c[0]:e[i]=c[0]+("["==sm?"le":"lt")+f+("]"==em?"le":"lt")+c[1],e[i]=e[i].replace("undefined",'"undefined"')):e[i]=sm+c[0]+","+c[1]+em}h&&(-1!=d.indexOf("inequality")?g.match(/all\s*real/)?a=g:(g=g.replace(/or/g,' \\ "or" \\ '),g=g.replace(/<=/g,"le"),g=g.replace(/>=/g,"ge"),g=g.replace(/</g,"lt"),g=g.replace(/>/g,"gt"),a=-1==d.indexOf("showval")?"`"+g+"`. "+wrapAMnotice(m):"`"+g+"= "+e.join(' \\ "or" \\ ')+"`. "+wrapAMnotice(m)):a=-1==d.indexOf("showval")?"`"+l.join("uu")+
"`. "+wrapAMnotice(m):-1!=d.indexOf("list")?"`"+l.join(",")+"` = "+e.join(" , ")+". "+wrapAMnotice(m):"`"+l.join("uu")+"` = "+e.join(" U ")+". "+wrapAMnotice(m))}a=a.replace(/[^\u0000-\u007f]/g,"?");b=b.substr(1);setupLivePreview(b);LivePreviews[b].RenderNow(a)}
function ntuplecalc(a,b,d){var c=document.getElementById(a).value;c=normalizemathunicode(c);c=c.replace(/\(:|<</g,"<").replace(/:\)|>>/g,">");c=-1!=d.indexOf("mixed")?c.replace(/_/g," ").replace(/^\s+/,"").replace(/\s+$/,""):c.replace(/^\s+/,"").replace(/\s+$/,"");if(c.match(/DNE/i))c.toUpperCase(),outstr=a="DNE";else if(c.match(/^\s*oo\s*$/i))c.toLowerCase(),a="oo",outstr="`oo`";else{a="";var e=0,g=0,f="",l=!0;c.charAt(0).match(/[\(\[<\{]/)||(l=!1);for(var h=0;h<c.length;h++)if(dec=!1,0==e&&(a+=
c.charAt(h),g=h+1,","==c.charAt(h)&&(c.substring(h+1).match(/^\s*[\(\[<\{]/)&&c.substring(0,h).match(/[\)\]>\}]\s*$/)||(l=!1))),c.charAt(h).match(/[\(\[<\{]/)?e++:c.charAt(h).match(/[\)\]>\}]/)&&(e--,dec=!0),0==e&&dec||1==e&&","==c.charAt(h)){sub=c.substring(g,h);g=NaN;if("oo"==sub||"-oo"==sub)a+=sub;else{f+=singlevalsyntaxcheck(sub,d);f+=syntaxcheckexpr(sub,d);try{-1!=d.indexOf("mixed")&&(sub=sub.replace(/(\d+)\s+(\d+|\(\d+\))\s*\/\s*(\d+|\(\d+\))/g,"($1+$2/$3)")),g=scopedmatheval(sub)}catch(m){f+=
_("syntax incomplete")+". "}a=isNaN(g)||"Infinity"==g||""===g?a+_("undefined"):a+g}a+=c.charAt(h);g=h+1}0!=e&&(l=!1);0==l&&(f+=_("Invalid notation")+". ");c=c.replace(/[^\u0000-\u007f]/g,"?");c=c.replace(/</g,"(:").replace(/>/g,":)");outstr=-1==d.indexOf("showval")||0==l?"`"+c+"`. "+wrapAMnotice(f):"`"+c+"` = "+a+". "+wrapAMnotice(f)}null!=b&&(b=b.substr(1),setupLivePreview(b),LivePreviews[b].RenderNow(outstr));return a}
function complexcalc(a,b,d){var c=document.getElementById(a).value;c=normalizemathunicode(c);c=-1!=d.indexOf("mixed")?c.replace(/_/g," ").replace(/^\s+/,"").replace(/\s+$/,""):c.replace(/^\s+/,"").replace(/\s+$/,"");if(c.match(/DNE/i))c.toUpperCase(),d=a="DNE";else{var e=a="";for(var g=c.split(","),f=0;f<g.length;f++){var l=g[f];-1!=d.indexOf("mixed")&&(l=l.replace(/(\d+)\s+(\d+|\(\d+\))\s*\/\s*(\d+|\(\d+\))/g,"($1+$2/$3)"));l=mathjs(l,"i");if(-1==d.indexOf("sloppycomplex")){var h=parsecomplex(g[f]);
"string"==typeof h?e+=h:(e+=singlevalsyntaxcheck(h[0],d),e+=singlevalsyntaxcheck(h[1],d))}e+=syntaxcheckexpr(g[f],d);if(""==e)try{var m=scopedeval("var i=0;"+prepWithMath(l)),n=scopedeval("var i=1;"+prepWithMath(l)),q=scopedeval("var i=-1;"+prepWithMath(l))}catch(p){e+=_("syntax incomplete")}if("synerr"==m||"synerr"==n)e+=_("syntax incomplete"),m=NaN;if(isNaN(m)||"Infinity"==m||isNaN(n)||isNaN(q)||"Infinity"==n){a+=_("undefined");break}else n-=m,0!=f&&(a+=","),a+=m+(0<=n?"+":"")+n+"i"}c=c.replace(/[^\u0000-\u007f]/g,
"?");d=-1==d.indexOf("showval")?"`"+c+"`. "+wrapAMnotice(e):"`"+c+"` = "+a+". "+wrapAMnotice(e)}null!=b&&(b=b.substr(1),setupLivePreview(b),LivePreviews[b].RenderNow(d));return a}
function parsecomplex(a){var b,d;a=a.replace(/\s/,"");a=a.replace(/\((\d+\*?i|i)\)\/(\d+)/g,"$1/$2");a=a.replace(/sin/,"s$n");a=a.replace(/pi/,"p$");var c=a.length;if(2<a.split("i").length)return _("error - more than 1 i in expression");var e=a.indexOf("i");if(-1==e){var g=a;var f="0"}else{f=0;for(d=e-1;0<d;d--)if(g=a.charAt(d),")"==g)f++;else if("("==g)f--;else if(("+"==g||"-"==g)&&0==f)break;0>d&&(d=0);if(0!=f)return _("error - invalid form");f=0;for(b=e+1;b<c;b++)if(g=a.charAt(b),"("==g)f++;else if(")"==
g)f--;else if(("+"==g||"-"==g)&&0==f)break;if(0!=f)return _("error - invalid form");if(0<e-d&&0<b-e&&(b==c||0==d)){if(b==c)g=a.substr(0,d),f=a.substr(d,e-d);else if(0==d)g=a.substr(b),f=a.substr(0,e);else return _("error - invalid form");f+="*"+a.substr(e+1+("*"==a.charAt(e+1)?1:0),b-e-1);f=f.replace("-*","-1*").replace("+*","+1*");f=f.replace(/(\+|-)1\*(.+)/g,"$1$2")}else if(1<e-d)f=a.substr(d,e-d),g=a.substr(0,d)+a.substr(e+1);else if(1<b-e)if(0<e){if("+"!=a.charAt(e-1)&&"-"!=a.charAt(e-1))return _("error - invalid form");
f=a.charAt(e-1)+a.substr(e+1+("*"==a.charAt(e+1)?1:0),b-e-1);g=a.substr(0,e-1)+a.substr(b)}else f=a.substr(e+1,b-e-1),g=a.substr(0,e)+a.substr(b);else f="+"==a.charAt(d)?"1":"-"==a.charAt(d)?"-1":0==e?"1":a.charAt(d),g=(0<e?a.substr(0,d):"")+a.substr(e+1);""==g&&(g="0");"/"==f.charAt(0)?f="1"+f:"+"!=f.charAt(0)&&"-"!=f.charAt(0)||"/"!=f.charAt(1)||(f=f.charAt(0)+"1"+f.substr(1));"*"==f.charAt(f.length-1)&&(f=f.substr(0,f.length-1));"+"==f.charAt(0)&&(f=f.substr(1));"+"==g.charAt(0)&&(g=g.substr(1))}g=
g.replace("s$n","sin");g=g.replace("p$","pi");f=f.replace("s$n","sin");f=f.replace("p$","pi");f=f.replace(/\*\//g,"/");return[g,f]}
function matrixcalc(a,b,d,c,e){function g(t){var r="";try{var u=scopedmatheval(t)}catch(v){r=_("syntax incomplete")+". "}isNaN(u)||"Infinity"==u||""===u?""!=t&&(t=r=_("undefined")+". "):t=(1E-15>Math.abs(u)?0:u)+r;return[t,r]}var f="";"string"!=typeof e&&(e="");if(null!=d&&null!=c){for(var l=0,h="[",m="[",n=0;n<d;n++){0<n&&(h+=",",m+=",");h+="(";m+="(";for(var q=0;q<c;q++){0<q&&(h+=",",m+=",");val=normalizemathunicode(document.getElementById(a+"-"+l).value);h+=val;var p=g(val);p[1]+=syntaxcheckexpr(val,
e);""==p[1]&&(p[1]+=singlevalsyntaxcheck(val,e));""==f&&(f=p[1]);m+=p[0];l++}h+=")";m+=")"}h+="]";m+="]"}else{h=normalizemathunicode(document.getElementById(a).value);p=0;m=h.replace("[","(");m=m.replace("]",")");m=m.replace(/\s+/g,"");d=[];m=m.substring(1,m.length-1);for(a=c=0;a<m.length;a++)"("==m.charAt(a)?p++:")"==m.charAt(a)?p--:","==m.charAt(a)&&0==p&&(d[d.length]=m.substring(c+1,a-1),c=a+1);d[d.length]=m.substring(c+1,m.length-1);for(a=0;a<d.length;a++){calclist2=d[a].split(",");for(m=0;m<
calclist2.length;m++)p=g(calclist2[m]),p[1]+=syntaxcheckexpr(calclist2[m],e),""==p[1]&&(p[1]+=singlevalsyntaxcheck(calclist2[m],e)),""==f&&(f=p[1]),calclist2[m]=p[0];d[a]=calclist2.join(",")}m="[("+d.join("),(")+")]"}h=h.replace(/[^\u0000-\u007f]/g,"?");h=-1==e.indexOf("showval")?"`"+h+"`. "+f:"`"+h+"` = `"+m+"`. "+f;if(null!=b){b=document.getElementById(b);e=b.childNodes.length;for(a=0;a<e;a++)b.removeChild(b.firstChild);b.appendChild(document.createTextNode(h));noMathRender||rendermathnode(b)}return m}
function mathjsformat(a,b){var d=document.getElementById(a).value;document.getElementById(b).value=mathjs(d)}function stringqpreview(a,b){var d=document.getElementById(a).value,c=b.substr(1);setupLivePreview(c);LivePreviews[c].RenderNow("`"+d+"`")}
function AMnumfuncPrepVar(a,b){var d=vlist[a],c=flist[a],e=d.split("|");e.push("DNE");d.match(/lambda/)&&(b=b.replace(/lamda/,"lambda"));b=b.replace(/,/g,"").replace(/^\s+/,"").replace(/\s+$/,"");b=normalizemathunicode(b);var g=[];var f=b.replace(/(arcsinh|arccosh|arctanh|arcsech|arccsch|arccoth|arcsin|arccos|arctan|arcsec|arccsc|arccot|sinh|cosh|tanh|sech|csch|coth|sqrt|ln|log|exp|sin|cos|tan|sec|csc|cot|abs|root)/g,functoindex);for(var l=0;l<e.length;l++)if("varE"==e[l])b=b.replace("E","varE"),
f=f.replace("E","varE");else{g[l]=!1;for(var h=0;h<e.length;h++)if(l!=h&&e[h].toLowerCase()==e[l].toLowerCase()&&e[h]!=e[l]){g[l]=!0;break}}b=b.replace(new RegExp("("+d+")","gi"),function(p,t){for(var r=0;r<e.length;r++)if(e[r]==t||!g[r]&&e[r].toLowerCase()==t.toLowerCase())return"@v"+r+"@"});b=b.replace(/@v(\d+)@/g,function(p,t){return e[t]});f=f.replace(new RegExp("("+d+")","gi"),function(p,t){for(var r=0;r<e.length;r++)if(e[r]==t||!g[r]&&e[r].toLowerCase()==t.toLowerCase())return"@v"+r+"@"});f=
f.replace(/(@v(\d+)@|\d+(\.\d+)?)!/g,"{:$&:}");f=f.replace(/@v(\d+)@/g,function(p,t){return e[t]});h=[];for(l=0;l<e.length;l++)if(1<e[l].length){var m=!1;-1!=arraysearch(e[l].toLowerCase(),greekletters)&&(m=!0);if(e[l].match(/^\w+_\w+$/)){m=g[l]?"g":"gi";var n=(new RegExp(/^(\w+)_(\w+)$/,m)).exec(e[l]),q=new RegExp(n[1]+"_\\("+n[2]+"\\)",m);f=f.replace(q,e[l]);b=b.replace(q,e[l]);1<n[1].length&&-1==arraysearch(n[1].toLowerCase(),greekletters)&&(n[1]='"'+n[1]+'"');1<n[2].length&&-1==arraysearch(n[2].toLowerCase(),
greekletters)&&(n[2]='"'+n[2]+'"');f=f.replace(new RegExp(n[0],m),n[1]+"_"+n[2]);b=b.replace(new RegExp(n[0],"g"),"repvars"+l);e[l]="repvars"+l}else m||"varE"==e[l]||h.push(e[l])}0<h.length&&(vltq=h.join("|"),f=f.replace(new RegExp("("+vltq+")","g"),'"$1"'));f=f.replace("varE","E");f=f.replace(/@(\d+)@/g,indextofunc);d.match(/\bf\b/)&&!c.match(/\bf\b/)&&(f=f.replace(/([^a-zA-Z])f\^([\d\.]+)([^\d\.])/g,"$1f^$2{::}$3"),f=f.replace(/([^a-zA-Z])f\(/g,"$1f{::}("));d.match(/\bg\b/)&&!c.match(/\bg\b/)&&
(f=f.replace(/([^a-zA-Z])g\^([\d\.]+)([^\d\.])/g,"$1g^$2{::}$3"),f=f.replace(/([^a-zA-Z])g\(/g,"$1g{::}("));return[b,f,e.join("|")]}
function AMpreview(a,b){var d=a.slice(2),c=AMnumfuncPrepVar(d,document.getElementById(a).value),e=c[0],g=c[1],f=c[2],l=flist[d];ptlist=pts[d].split(",");var h="",m=0;c=NaN;var n=!1;1==iseqn[d]?(e.match(/=/)?1<e.match(/=/g).length&&(n=!0):n=!0,e=e.replace(/(.*)=(.*)/,"$1-($2)")):e.match(/=/)||(n=!0);""!=l&&(reg=new RegExp("("+l+")\\(","g"),e=e.replace(reg,"$1*sin($1+"));vars=f.split("|");for(l=prepWithMath(mathjs(e,f));m<ptlist.length&&(isNaN(c)||"Infinity"==c);){var q="";testvals=ptlist[m].split("~");
for(h=0;h<vars.length;h++)q+="var "+vars[h]+"="+testvals[h]+";";q+=l;h=_("syntax ok");try{c=scopedeval(q)}catch(p){h=_("syntax error")}"synerr"==c&&(h=_("syntax error"));m++}f=syntaxcheckexpr(e,"",f);if(isNaN(c)||"Infinity"==c)h=_("syntax error");""!=f&&(h=h==_("syntax ok")?h+(". "+_("warning")+": "+f):h+(". "+f));onlyAscii.test(e)||(h+=". "+_("Your answer contains an unrecognized symbol"),g=g.replace(/[^\u0000-\u007f]/g,"?"));1==iseqn[d]&&n?h=_("syntax error: this is not an equation"):"undefined"!==
typeof iseqn[d]||n||(h=_("syntax error: you gave an equation, not an expression"));if('"DNE"'==g||"oo"==g)h=_("syntax ok");d=b.substr(1);setupLivePreview(d);LivePreviews[d].RenderNow("`"+g+"` "+wrapAMnotice(h))}function AMmathpreview(a,b){for(var d=document.getElementById(a).value,c=document.getElementById(b),e=c.childNodes.length,g=0;g<e;g++)c.removeChild(c.firstChild);c.appendChild(document.createTextNode("`"+d+"`"));noMathRender||rendermathnode(c)}
function singlevalsyntaxcheck(a,b){if(!(a.match(/DNE/i)||a.match(/oo$/)||a.match(/oo\W/)||-1!=b.indexOf("allowmixed")&&a.match(/^\s*\-?\s*\d+\s*(_|\s)\s*(\d+|\(\d+\))\s*\/\s*(\d+|\(\d+\))\s*$/)))if(-1!=b.indexOf("fracordec")){if(a=a.replace(/([0-9])\s+([0-9])/g,"$1*$2").replace(/\s/g,""),!a.match(/^\-?\(?\d+\s*\/\s*\-?\d+\)?$/)&&!a.match(/^\-?\d+$/)&&!a.match(/^\-?(\d+|\d+\.\d*|\d*\.\d+)$/))return _(" invalid entry format")+". "}else if(-1!=b.indexOf("fraction")||-1!=b.indexOf("reducedfraction")){if(a=
a.replace(/([0-9])\s+([0-9])/g,"$1*$2").replace(/\s/g,""),!a.match(/^\(?\-?\(?\d+\)?\/\(?\d+\)?$/)&&!a.match(/^\(?\d+\)?\/\(?\-?\d+\)?$/)&&!a.match(/^\s*?\-?\d+\s*$/))return _("not a valid fraction")+". "}else if(-1!=b.indexOf("mixednumber")){if(!(a.match(/^\(?\-?\s*\(?\d+\)?\/\(?\d+\)?$/)||a.match(/^\(?\d+\)?\/\(?\-?\d+\)?$/)||a.match(/^\s*\-?\s*\d+\s*(_|\s)\s*(\d+|\(\d+\))\s*\/\s*(\d+|\(\d+\))\s*$/)||a.match(/^\s*\-?\s*\d+\s*$/)))return _("not a valid mixed number")+". ";a.replace(/_/," ")}else if(-1!=
b.indexOf("scinot")){if(a=a.replace(/\s/g,""),a=a.replace(/(x|X|\u00D7)/,"xx"),!a.match(/^\-?[1-9](\.\d*)?(\*|xx)10\^(\(?\-?\d+\)?)$/)){if(-1==b.indexOf("scinotordec"))return _("not valid scientific notation")+". ";if(!a.match(/^\-?(\d+|\d+\.\d*|\d*\.\d+)$/))return _("not valid decimal or scientific notation")+". "}}else if(-1!=b.indexOf("decimal")&&-1==b.indexOf("nodecimal")){if(!a.match(/^\-?(\d+|\d+\.\d*|\d*\.\d+)$/))return _(" not a valid integer or decimal number")+". "}else if(!onlyAscii.test(a))return _("Your answer contains an unrecognized symbol")+
". ";return""}
function syntaxcheckexpr(a,b,d){var c="";-1!=b.indexOf("notrig")&&a.match(/(sin|cos|tan|cot|sec|csc)/i)?c+=_("no trig functions allowed")+". ":-1!=b.indexOf("nodecimal")&&-1!=a.indexOf(".")?c+=_("no decimals allowed")+". ":-1==b.indexOf("mixed")&&a.match(/\-?\s*\d+\s*(_|\s)\s*(\d+|\(\d+\))\s*\/\s*(\d+|\(\d+\))/)&&(c+=_("mixed numbers are not allowed")+". ");for(var e=b=0,g=0,f=0;f<a.length;f++)"("==a.charAt(f)?b++:")"==a.charAt(f)?b--:"["==a.charAt(f)?e++:"]"==a.charAt(f)?e--:"|"==a.charAt(f)&&(g=
1-g);if(0!=b||0!=e)c+=" ("+_("unmatched parens")+"). ";0!=g&&(c+=" ("+_("unmatched absolute value bars")+"). ");reg=d?new RegExp("(sqrt|ln|log|exp|sinh|cosh|tanh|sech|csch|coth|sin|cos|tan|sec|csc|cot|abs)s*("+d+"|\\d+)","i"):/(sqrt|ln|log|exp|sinh|cosh|tanh|sech|csch|coth|sin|cos|tan|sec|csc|cot|abs)s*(\d+)/i;errstuff=a.match(reg);null!=errstuff&&(c+="["+_("use function notation")+" - "+_("use $1 instead of $2",errstuff[1]+"("+errstuff[2]+")",errstuff[0])+"]. ");d&&(reg=new RegExp("(repvars\\d+|arc|sqrt|root|ln|log|exp|sinh|cosh|tanh|sech|csch|coth|sin|cos|tan|sec|csc|cot|abs|pi|sign|DNE|e|oo|"+
d+")","ig"),a.replace(reg,"").match(/[a-zA-Z]/)&&(c+=_(" Check your variables - you might be using an incorrect one")+". "));if(2<(a.match(/\|/g)||[]).length)for(d=/\|.*?\|\s*(.|$)/g;match=d.exec(a);)if(""!=match[1]&&match[1].match(/[^+\-\*\/\^\)]/)){c+=_(" You may want to use abs(x) instead of |x| for absolute values to avoid ambiguity")+". ";break}a.match(/%/)&&!a.match(/^\s*[+-]?\s*((\d+(\.\d*)?)|(\.\d+))\s*%\s*$/)&&(c+=_(" Do not use the percent symbol, %")+". ");return c}
var greekletters="alpha beta chi delta epsilon gamma varphi phi psi sigma rho theta lambda mu nu omega tau".split(" "),calctoproc={},intcalctoproc={},calcformat={},functoproc={},matcalctoproc={},ntupletoproc={},complextoproc={},callbackstack={},matsize={},vlist={},flist={},pts={},iseqn={};
function doonsubmit(a,b,d){for(var c in callbackstack)callbackstack[c](c);if(null!=a){if("submitted"==a.className)return alert(_("You have already submitted this page.  Please be patient while your submission is processed.")),a.className="submitted2",!1;if("submitted2"==a.className)return!1;a.className="submitted";if(!d&&(b&&1==$("input[name=saveforlater]").attr("data-clicked")?(b=!0,$("input[name=saveforlater]").attr("data-clicked",0)):b=confirmSubmit(a),!b))return a.className="",!1}imathasDraw.encodea11ydraw();
for(c in intcalctoproc)if(c=parseInt(c),null!=document.getElementById("tc"+c)){fullstr=document.getElementById("tc"+c).value;fullstr=-1!=calcformat[c].indexOf("mixed")?fullstr.replace(/_/g," ").replace(/^\s+/,"").replace(/\s+$/,""):fullstr.replace(/\s+/g,"");fullstr=normalizemathunicode(fullstr);if(fullstr.match(/DNE/i))fullstr=fullstr.toUpperCase();else{-1!=calcformat[c].indexOf("inequality")&&(fullstr=ineqtointerval(fullstr));if(-1!=calcformat[c].indexOf("list")){b=0;a=[];for(d=1;d<fullstr.length-
1;d++)","!=fullstr.charAt(d)||")"!=fullstr.charAt(d-1)&&"]"!=fullstr.charAt(d-1)||"("!=fullstr.charAt(d+1)&&"["!=fullstr.charAt(d+1)||(a.push(fullstr.substring(b,d)),b=d+1);a.push(fullstr.substring(b))}else a=fullstr.split(/\s*U\s*/i);for(k=0;k<a.length;k++)if(str=a[k],0<str.length&&str.match(/,/)){sm=str.charAt(0);em=str.charAt(str.length-1);vals=str.substring(1,str.length-1);vals=vals.split(/,/);for(j=0;2>j;j++)if(!vals[j].match(/oo$/)&&!vals[j].match(/oo\W/)){b="";try{-1!=calcformat[c].indexOf("mixed")&&
(vals[j]=vals[j].replace(/(\d+)\s+(\d+|\(\d+\))\s*\/\s*(\d+|\(\d+\))/g,"($1+$2/$3)"));var e=scopedmatheval(vals[j])}catch(g){b="syntax incomplete"}isNaN(e)||"Infinity"==e||""===e||(vals[j]=(1E-15>Math.abs(e)?0:e)+b)}a[k]=sm+vals[0]+","+vals[1]+em}fullstr=-1!=calcformat[c].indexOf("list")?a.join(","):a.join("U")}document.getElementById("qn"+c).value=fullstr}for(c in calctoproc)if(c=parseInt(c),null!=document.getElementById("tc"+c)){str=document.getElementById("tc"+c).value;str=normalizemathunicode(str);
str=str.replace(/=/,"");if(-1!=calcformat[c].indexOf("list"))a=str.split(/,/);else if(-1!=calcformat[c].indexOf("set"))if(str.match(/^\s*{.*?}\s*$/))a=str.replace(/^\s*{(.*?)}\s*$/,"$1").split(/,/);else continue;else a=[],a[0]=str;for(b=0;b<a.length;b++){str=a[b];str=str.replace(/(\d)\s*,\s*(?=\d{3}\b)/g,"$1");str=str.replace(",","*NaN*");if(-1!=calcformat[c].indexOf("scinot")||-1!=calcformat[c].indexOf("allowxtimes"))str=str.replace(/(x|X|\u00D7)/,"*");str.match(/^\s*[+-]?\s*((\d+(\.\d*)?)|(\.\d+))\s*%\s*$/)&&
(str=str.replace(/%/,"")+"/100");str=str.replace(/(\d+)\s*_\s*(\d+|\(\d+\))\s*\/\s*(\d+|\(\d+\))/g,"($1+$2/$3)");-1!=calcformat[c].indexOf("mixed")&&(str=str.replace(/(\d+)\s+(\d+|\(\d+\))\s*\/\s*(\d+|\(\d+\))/g,"($1+$2/$3)"));e=str.match(/^\s*$/)?"":str.match(/oo$/)||str.match(/oo\W/)?str:str.match(/DNE/i)?str.toUpperCase():scopedmatheval(str);a[b]=e}document.getElementById("qn"+c).value=a.join(",")}for(c in matcalctoproc){c=parseInt(c);if(null!=matsize[c]){if(null==document.getElementById("qn"+
c+"-0"))continue;msize=matsize[c].split(",");str=matrixcalc("qn"+c,null,msize[0],msize[1])}else{if(null==document.getElementById("tc"+c))continue;str=matrixcalc("tc"+c,null)}document.getElementById("qn"+c).value=str}for(c in ntupletoproc)c=parseInt(c),null!=document.getElementById("tc"+c)&&(str=ntuplecalc("tc"+c,null,calcformat[c]),document.getElementById("qn"+c).value=str);for(c in complextoproc)c=parseInt(c),null!=document.getElementById("tc"+c)&&(str=complexcalc("tc"+c,null,calcformat[c]),document.getElementById("qn"+
c).value=str);for(c in functoproc)if(c=parseInt(c),null!=document.getElementById("tc"+c)){str=document.getElementById("tc"+c).value;str=str.replace(/,/g,"");str=normalizemathunicode(str);e=AMnumfuncPrepVar(c,str);str=e[0];varlist=e[2];if(1==iseqn[c])str=str.replace(/(.*)=(.*)/,"$1-($2)");else if(str.match("="))continue;fl=flist[c];""!=fl&&(reg=new RegExp("("+fl+")\\(","g"),str=str.replace(reg,"$1*sin($1+"));vars=varlist.split("|");e=document.getElementById("qn"+c);e.value=mathjs(str,varlist);ptlist=
pts[c].split(",");vals=[];for(a=0;a<ptlist.length;a++){inputs=ptlist[a].split("~");totest="";for(b=0;b<inputs.length;b++)totest+="var "+vars[b]+"="+inputs[b]+";";totest=""==e.value?totest+(Math.random()+";"):totest+(prepWithMath(e.value)+";");try{vals[a]=scopedeval(totest)}catch(g){vals[a]=NaN}"synerr"==vals[a]&&(vals[a]=NaN)}document.getElementById("qn"+c+"-vals").value=vals.join(",")}return!0}function scopedeval(a){try{return eval(a)}catch(b){return"synerr"}}
function scopedmatheval(a){if(a.match(/^\s*[a-df-zA-Z]\s*$/))return"";try{return eval(prepWithMath(mathjs(a)))}catch(b){return""}}function arraysearch(a,b){for(var d=0;d<b.length;d++)if(b[d]==a)return d;return-1}
function toggleinlinebtn(a,b){var d=document.getElementById(b),c=document.getElementById(a);"none"==c.style.display?(c.style.display="",c.setAttribute("aria-hidden",!1),d.setAttribute("aria-expanded",!0)):(c.style.display="none",c.setAttribute("aria-hidden",!0),d.setAttribute("aria-expanded",!1));c=d.innerHTML;d.innerHTML=c.match(/\[\+\]/)?c.replace(/\[\+\]/,"[-]"):c.replace(/\[\-\]/,"[+]")}var backgsavetimer=null;
function assessbackgsave(){var a=this;window.clearTimeout(backgsavetimer);backgsavetimer=window.setTimeout(function(){doassessbackgsave(a)},500)}
function doassessbackgsave(a){a=$(a).attr("name").match(/^(qs|qn|tc)(\d+)/);if(null!==a&&window.FormData){a=1*a[2];1E3<=a&&(a=Math.floor(a/1E3+.001)-1);"undefined"!=typeof tinyMCE&&tinyMCE.triggerSave();doonsubmit();var b=new FormData,d=new RegExp("^(qn|tc|qs)("+a+"\\b|"+(a+1)+"\\d{3})");$("input,select,textarea").each(function(c,e){e.name.match(d)&&("radio"!=e.type&&"checkbox"!=e.type||e.checked)&&("file"==e.type?b.append(e.name,e.files[0]):b.append(e.name,e.value))});b.append("backgroundsaveforlater",
1);b.append("tosaveqn",a);b.append("asidverify",document.getElementById("asidverify").value);b.append("disptime",document.getElementById("disptime").value);b.append("isreview",document.getElementById("isreview").value);$.ajax({type:"POST",url:window.location.origin+window.location.pathname,data:b,contentType:!1,processData:!1,qn:a}).done(function(c){-1!=assessFormIsDirty.indexOf(1*this.qn)&&assessFormIsDirty.splice(assessFormIsDirty.indexOf(1*this.qn),1)})}}
function assessbackgsubmit(a,b){a=parseInt(a);if(!confirmSubmit($("#embedqwrapper"+a)[0]))return!1;"undefined"!=typeof tinyMCE&&tinyMCE.triggerSave();doonsubmit();var d={},c=!!window.FormData;if(c)var e=new FormData;for(var g=[],f=document.getElementsByTagName("input"),l=0;l<f.length;l++)g.push(f[l]);f=document.getElementsByTagName("select");for(l=0;l<f.length;l++)g.push(f[l]);f=document.getElementsByTagName("textarea");for(l=0;l<f.length;l++)g.push(f[l]);f=null!=a?new RegExp("^(qn|tc|qs)("+a+"\\b|"+
(a+1)+"\\d{3})"):/^(qn|tc|qs)/;for(l=0;l<g.length;l++)g[l].name.match(f)&&("radio"!=g[l].type&&"checkbox"!=g[l].type||g[l].checked)&&(c?"file"==g[l].type?e.append(g[l].name,g[l].files[0]):e.append(g[l].name,g[l].value):"file"==g[l].type?alert("File upload submissions are not supported by this browser"):d[g[l].name]=g[l].value);null!==a?c?(e.append("toscore",a),e.append("verattempts",document.getElementById("verattempts"+a).value)):(d.toscore=a,d.verattempts=document.getElementById("verattempts"+a).value):
c?e.append("verattempts",document.getElementById("verattempts").value):d.verattempts=document.getElementById("verattempts").value;c?(e.append("asidverify",document.getElementById("asidverify").value),e.append("disptime",document.getElementById("disptime").value),e.append("isreview",document.getElementById("isreview").value)):(d.asidverify=document.getElementById("asidverify").value,d.disptime=document.getElementById("disptime").value,d.isreview=document.getElementById("isreview").value);d={type:"POST",
url:assesspostbackurl,data:c?e:d,dataType:"text",qn:a,noticetgt:b};c&&(d.contentType=!1,d.processData=!1);$.ajax(d).done(function(h){null!=this.noticetgt&&(document.getElementById(this.noticetgt).innerHTML="");if(null!==this.qn){for(var m=this.qn,n=[];-1<h.indexOf("<script")||-1<h.indexOf("\x3c/script");){var q=h.indexOf("<script"),p=h.indexOf(">",q),t=h.indexOf("\x3c/script",q),r=h.indexOf(">",t);n.push(h.substring(p+1,t));h=h.substring(0,q)+h.substring(r+1)}document.getElementById("embedqwrapper"+
m).innerHTML=h;usingASCIIMath&&rendermathnode(document.getElementById("embedqwrapper"+m));usingASCIISvg&&setTimeout("drawPics()",100);usingTinymceEditor&&initeditor("textareas","mceEditor");for(h=initstack.length=0;h<n.length;h++)try{if(k=n[h].match(/canvases\[(\d+)\]/))"undefined"!=typeof G_vmlCanvasManager&&(n[h]=n[h]+'G_vmlCanvasManager.initElement(document.getElementById("canvas'+k[1]+'"));'),n[h]=n[h]+"imathasDraw.initCanvases("+k[1]+");";eval(n[h])}catch(v){}for(h=0;h<initstack.length;h++)initstack[h]();
n=(m+1).toString().length;for(h in LivePreviews)(h==m||999<h&&h.toString().substr(0,n)==m+1)&&LivePreviews[h].Init();$(window).trigger("ImathasEmbedReload",[m]);-1!=assessFormIsDirty.indexOf(1*m)&&assessFormIsDirty.splice(assessFormIsDirty.indexOf(1*m),1);$("#embedqwrapper"+m).find("input,textarea").on("change",trackDirty);n=0;"undefined"!=typeof window.pageYOffset?n=window.pageYOffset:(n=document.body,h=document.documentElement,h=h.clientHeight?h:n,n=h.scrollTop);var u=findPos(document.getElementById("embedqwrapper"+
m))[1];n>u&&setTimeout(function(){window.scroll(0,u)},150)}}).fail(function(h){null!=this.noticetgt&&(document.getElementById(this.noticetgt).innerHTML=_("Submission Error"))})}function embedEnterHandler(a){$("#"+a+" input[type=text][name^=qn]").off("keydown.embedenterhandler").on("keydown.embedenterhandler",function(b){13==b.which&&(b.preventDefault(),b=parseInt($(this).closest(".embedqwrapper").attr("id").substr(13)),assessbackgsubmit(b,"submitnotice"+b))})}
$(window).on("ImathasEmbedReload",function(a,b){embedEnterHandler("embedqwrapper"+b)});
function AutoSuggest(a,b){var d=this;this.elem=a;this.suggestions=b;this.eligible=[];this.inputText=null;this.highlighted=-1;this.div=document.getElementById("autosuggest");null==this.div&&(this.div=document.createElement("div"),this.div.id="autosuggest",document.getElementsByTagName("body")[0].appendChild(this.div),this.div.appendChild(document.createElement("ul")));a.setAttribute("autocomplete","off");if(!a.id){var c="autosuggest"+AutoSuggestIdCounter;AutoSuggestIdCounter++;a.id=c}a.onkeydown=function(e){e=
d.getKeyCode(e);switch(e){case 9:d.useSuggestion("tab");break;case 13:return d.useSuggestion("enter"),!1;case 27:d.hideDiv();break;case 38:0<d.highlighted&&d.highlighted--;d.changeHighlight(e);break;case 40:d.highlighted<d.eligible.length-1&&d.highlighted++,d.changeHighlight(e)}};a.onkeyup=function(e){switch(d.getKeyCode(e)){case 9:case 27:case 38:case 40:break;default:1<this.value.length?(d.inputText=this.value,d.getEligible(),d.highlighted=0<d.eligible.length?0:-1,d.createDiv(),d.positionDiv(),
d.showDiv()):(d.hideDiv(),0==this.value.length&&(d.inputText=""))}};a.onblur=function(e){setTimeout(d.hideDiv,100)};this.useSuggestion=function(e){-1<this.highlighted&&(this.elem.value=this.eligible[this.highlighted]);this.hideDiv()};this.showDiv=function(){this.div.style.display="block"};this.hideDiv=function(){d.div.style.display="none";d.highlighted=-1};this.changeHighlight=function(){var e=this.div.getElementsByTagName("LI");for(i in e)e[i].className=this.highlighted==i?"selected":""};this.positionDiv=
function(){var e=this.elem,g=findPos(e);g[1]+=e.offsetHeight;this.div.style.left=g[0]+"px";this.div.style.top=g[1]+"px"};this.createDiv=function(){var e=document.createElement("ul");for(i in this.eligible){var g=this.eligible[i],f=document.createElement("li"),l=document.createElement("a");l.href="#";l.onclick=function(){return!1};l.innerHTML=g;f.appendChild(l);d.highlighted==i&&(f.className="selected");e.appendChild(f)}this.div.replaceChild(e,this.div.childNodes[0]);e.onmouseover=function(h){for(h=
d.getEventSource(h);h.parentNode&&"LI"!=h.tagName.toUpperCase();)h=h.parentNode;var m=d.div.getElementsByTagName("LI");for(i in m)if(m[i]==h){d.highlighted=i;break}d.changeHighlight()};e.onclick=function(h){d.useSuggestion("click");d.hideDiv();d.cancelEvent(h);return!1};this.div.className="suggestion_list";this.div.style.position="absolute"};this.getEligible=function(){this.eligible=[];if(-1==this.inputText.indexOf(" ")){var e=new RegExp("\\b"+this.inputText.toLowerCase());for(i in this.suggestions){var g=
this.suggestions[i];g.toLowerCase().match(e)&&(this.eligible[this.eligible.length]=g)}}};this.getKeyCode=function(e){if(e)return e.keyCode;if(window.event)return window.event.keyCode};this.getEventSource=function(e){if(e)return e.target;if(window.event)return window.event.srcElement};this.cancelEvent=function(e){e&&(e.preventDefault(),e.stopPropagation());window.event&&(window.event.returnValue=!1)}}var AutoSuggestIdCounter=0;function isBlank(a){return!a||0===a.length||/^\s*$/.test(a)}
function editdebit(a){var b=$(a).closest("tr").find("input").first();!isBlank(a.value)&&b.hasClass("iscredit")&&(b.is("select")?b.css("margin-right",20):b.width(b.width()+20),b.css("padding-left",0),b.removeClass("iscredit"))}function editcredit(a){var b=$(a).closest("tr").find("input").first();isBlank(a.value)||b.hasClass("iscredit")||(b.is("select")?b.css("margin-right",0):b.width(b.width()-20),b.css("padding-left",20),b.addClass("iscredit"))}
function initcreditboxes(){$(".creditbox").each(function(a,b){if(!isBlank(b.value)&&20!=$(b).css("padding-left")){var d=$(b).closest("tr").find("input").first();d.is("select")?d.css("margin-right",0):d.width(d.width()-20);d.css("padding-left",20);d.addClass("iscredit")}})}initstack.push(initcreditboxes);$(window).on("ImathasEmbedReload",initcreditboxes);
function initqsclickchange(){$("input[id^=qs][value=spec]").each(function(a,b){$(b).siblings("input[type=text]").off("keyup.qsclickchange").on("keyup.qsclickchange",function(d){8!=d.keyCode&&46!=d.keyCode&&$(b).prop("checked",!0)})})}$(window).on("ImathasEmbedReload",initqsclickchange);initstack.push(initqsclickchange);
function initShowAnswer(){$("input.sabtn + span.hidden").attr("aria-hidden",!0);$("input.sabtn").each(function(){var a=$(this).siblings("span:first-of-type").attr("id");$(this).attr("aria-expanded",!1).attr("aria-controls",a).off("click.sashow").on("click.sashow",function(){"true"==$(this).attr("aria-expanded")?$(this).attr("aria-expanded",!1).siblings("span:first-of-type").attr("aria-hidden",!0).addClass("hidden"):$(this).attr("aria-expanded",!0).siblings("span:first-of-type").attr("aria-hidden",
!1).removeClass("hidden")})});$("input.dsbtn + div.hidden").attr("aria-hidden",!0);$("input.dsbtn").each(function(){var a=$(this).siblings("div:first-of-type").attr("id");$(this).attr("aria-expanded",!1).attr("aria-controls",a).off("click.sashow").on("click.sashow",function(){"true"==$(this).attr("aria-expanded")?$(this).attr("aria-expanded",!1).siblings("div:first-of-type").attr("aria-hidden",!0).addClass("hidden"):$(this).attr("aria-expanded",!0).siblings("div:first-of-type").attr("aria-hidden",
!1).removeClass("hidden")})})}$(window).on("ImathasEmbedReload",initShowAnswer);initstack.push(initShowAnswer);
function assessmentTimer(a,b){var d=Date.now(),c,e,g,f,l;var h=setInterval(function(){c=a-Math.floor((Date.now()-d)/1E3);if(0>=c){c=0;clearInterval(h);if(b){document.getElementById("timelimitholder").className="noticetext";document.getElementById("timelimitholder").innerHTML=_("Time limit expired - submitting now");document.getElementById("timelimitholder").style.fontSize="300%";if(null==document.getElementById("qform")){setTimeout("window.location.href='"+imasroot+"/assessment/showtest.php?action=skip&superdone=true'",
2E3);return}var m=document.getElementById("qform"),n=m.getAttribute("action");m.setAttribute("action",n+"&superdone=true");doonsubmit(m,!0,!0)&&setTimeout('document.getElementById("qform").submit()',2E3);return 0}alert(_("Time Limit has elapsed"))}f=Math.floor(c%60);g=Math.floor(c/60%60);e=Math.floor(c/3600);0==e&&5>g&&(document.getElementById("timeremaining").className="noticetext");0==e&&0==g&&5>=f&&(document.getElementById("timeremaining").style.fontSize="150%");l=(0<e?e+":":"")+(0<e&&10>g?"0":
"")+g+":"+(10>f?"0":"")+f;document.getElementById("timeremaining").innerHTML=l},1E3);$(document).ready(function(){var m=$("#timerwrap"),n=m.position();$(window).scroll(function(){$(window).scrollTop()>=n.top?m.addClass("sticky"):m.removeClass("sticky")})})}
function toggletimer(){"[x]"==$("#timerhide").text()?($("#timercontent").hide(),$("#timerhide").text("["+_("Show Timer")+"]"),$("#timerhide").attr("title","["+_("Show Timer")+"]")):($("#timercontent").show(),$("#timerhide").text("[x]"),$("#timerhide").attr("title",_("Hide Timer")))}
function toggleintroshow(a){var b=document.getElementById("introtoggle"+a);a=document.getElementById("intropiece"+a);b.innerHTML.match("Hide")?(b.innerHTML=b.innerHTML.replace("Hide","Show"),$(b).attr("aria-expanded",!1),a.style.display="none",$(a).attr("aria-hidden",!0).attr("aria-expanded",!1)):(b.innerHTML=b.innerHTML.replace("Show","Hide"),$(b).attr("aria-expanded",!0),a.style.display="block",$(a).attr("aria-hidden",!1).attr("aria-expanded",!0))}
function togglemainintroshow(a){$("#intro").hasClass("hidden")?($(a).html(_("Hide Intro/Instructions")).attr("aria-expanded",!0),$("#intro").removeClass("hidden").addClass("intro").attr("aria-hidden",!1).attr("aria-expanded",!0)):($("#intro").addClass("hidden").attr("aria-hidden",!0).attr("aria-expanded",!1),$(a).html(_("Show Intro/Instructions")).attr("aria-expanded",!1))}
function prepWithMath(a){a=a.replace(/\b(abs|acos|asin|atan|ceil|floor|cos|sin|tan|sqrt|exp|max|min|pow)\(/g,"Math.$1(");a=a.replace(/\(E\)/g,"(Math.E)");return a=a.replace(/\((PI|pi)\)/g,"(Math.PI)")}var assessFormIsDirty=[];function trackDirty(){var a=$(this).attr("name").match(/^(qs|qn|tc)(\d+)/);null!==a&&(a=1*a[2],1E3<a&&(a=Math.floor(a/1E3+.001)-1),-1==assessFormIsDirty.indexOf(a)&&assessFormIsDirty.push(a))}
$(function(){$("div.question").find("input,select,textarea").on("change",trackDirty);$(window).on("beforeunload",function(){if(0==$("form.submitted,form.submitted2").length&&0<assessFormIsDirty.length)return _("Are you sure you want to leave this assessment? You may have unsubmitted work")})});

function checkComplete(b){if("undefined"!=typeof tinyMCE)try{tinyMCE.triggerSave()}catch(d){}var c=!0;$(b).find("input:visible,textarea:visible,select:visible").each(function(d,a){if("undefined"==typeof a.type||"undefined"==typeof a.name||""==a.name)return 1;if("text"==a.type||"textarea"==a.type||"password"==a.type||"file"==a.type)""==a.value&&0==$("#qs"+a.id.substr(2)+"-d:checked,#qs"+a.id.substr(2)+"-i:checked").length&&(c=!1);else if(-1!=a.type.indexOf("select")){if(-1==a.selectedIndex||"qn"==
a.name.substr(0,2)&&0==a.selectedIndex)c=!1}else"radio"==a.type&&0==$("input[name="+a.name+"]:checked").length&&(c=!1)});return c}function confirmSubmit(b){return checkComplete(b)?!0:confirm("Not all question parts have been answered.  Are you sure you want to submit this question?")}
function confirmSubmit2(b){return checkComplete(b)?!0:confirm("Not all questions have been answered completely.  If you are saving your answers for later, this is fine.  If you are submitting for grading, are you sure you want to submit now?")};

var canvases=[],drawla=[],imathasDraw=function(u){function U(d,f){var c=d[0],b=d[1].substr(9).split(","),l=d[2],t=d[3],h=d[4],D=d[5];h==D&&(h=-1,D=1);var k=d[6],w=d[7],v=d[8],y=document.getElementById("a11ydraw"+c);if(null==y){var I=document.getElementById("canvas"+c);if(I){var J=u("<div>").append(u("<p>",{text:_("Drawn Elements:")}));y=document.createElement("ul");y.setAttribute("id","allydraw"+c);J.append(y);u(I).replaceWith(J)}}Z[c]=document.getElementById("qn"+c);Z[c].disabled&&(document.getElementById("a11ydrawnew"+
c).disabled=!0,u(".a11ydrawadd[data-qn="+c+"]").prop("disabled",!0));g[c]={type:"a11y",el:y,xmin:l,xmax:t,ymin:h,ymax:D,imgborder:k,imgwidth:w,imgheight:v};g[c].pixperx=(w-2*k)/(t-l);g[c].pixpery=h==D?1:(v-2*k)/(D-h);"inequality"==b[0]?(l=b.shift(),0==b.length?b=["line"]:"both"==b[0]&&(b=["line","parab"])):"twopoint"==b[0]?(l=b.shift(),0==b.length&&(b=["line","parab","abs","circle","dot"])):"numberline"==b[0]?(l="basic",b.shift()):l="basic";g[c].afgroup=l;t={inequality:{line:[{mode:10,descr:_("Linear inequality with solid line"),
inN:3,input:_("Enter 2 points on the line, then a third point in the shaded region")},{mode:10.2,descr:_("Linear inequality with dashed line"),inN:3,input:_("Enter 2 points on the line, then a third point in the shaded region")}],parab:[{mode:10.3,descr:_("Parabolic inequality with solid line"),inN:3,input:_("Enter 2 points on the line, then a third point in the shaded region")},{mode:10.4,descr:_("Parabolic inequality with dashed line"),inN:3,input:_("Enter 2 points on the line, then a third point in the shaded region")}]},
twopoint:{line:[{mode:5,descr:_("Line"),inN:2,input:_("Enter two points on the line")}],lineseg:[{mode:5.3,descr:_("Line segment"),inN:2,input:_("Enter the starting and ending point of the line segment")}],ray:[{mode:5.2,descr:_("Ray"),inN:2,input:_("Enter the starting point of the ray and another point on the ray")}],parab:[{mode:6,descr:_("Parabola"),inN:2,input:_("Enter the vertex, then another point on the parabola")}],horizparab:[{mode:6.1,descr:_("Parabola opening right or left"),inN:2,input:_("Enter the vertex, then another point on the parabola")}],
cubic:[{mode:6.3,descr:_("Cubic"),inN:2,input:_("Enter the inflection point, then another point on the cubic")}],cuberoot:[{mode:6.6,descr:_("Cube root"),inN:2,input:_("Enter the inflection point of the cube root, then another point on the graph")}],abs:[{mode:8,descr:_("Absolute value"),inN:2,input:_("Enter the corner point of the absolute value, then another point on the graph")}],rational:[{mode:8.2,descr:_("Rational"),inN:2,input:_("Enter the point where the vertical and horizontal asymptote cross, then a point on the graph")}],
exp:[{mode:8.3,descr:_("Exponential"),inN:2,input:_("Enter two points on the graph")}],log:[{mode:8.4,descr:_("Logarithm"),inN:2,input:_("Enter two points on the graph")}],genexp:[{mode:8.5,descr:_("Shifted Exponential"),inN:3,input:_("Enter a point on the asymptote, then enter two points on the graph")}],genlog:[{mode:8.6,descr:_("Shifted Logarithm"),inN:3,input:_("Enter a point on the asymptote, then enter two points on the graph")}],circle:[{mode:7,descr:_("Circle"),inN:2,input:_("Enter the center point of the circle, then a point on the graph")}],
ellipse:[{mode:7.2,descr:_("Ellipse"),inN:2,input:_("Enter the center point of the ellipse, then a point offset from the center by the horizontal radius and vertical radius")}],hyperbola:[{mode:7.4,descr:_("Vertical hyperbola"),inN:2,input:_("Enter the center point of the hyperbola, then a point (x,y) where x is the x-coordinate of the co-vertex and y is the y-coordinate of the vertex")},{mode:7.5,descr:_("Horizontal hyperbola"),inN:2,input:_("Enter the center point of the hyperbola, then a point (x,y) where x is the x-coordinate of the vertex and y is the y-coordinate of the co-vertex")}],
dot:[{mode:1,descr:_("Solid dot"),inN:1,input:_("Enter the coordinates of the dot")}],opendot:[{mode:2,descr:_("Open dot"),inN:1,input:_("Enter the coordinates of the dot")}],trig:[{mode:9,descr:_("Cosine"),inN:2,input:_("Enter a point at the start of a phase, then a point half a phase further")},{mode:9.2,descr:_("Sine"),inN:2,input:_("Enter a point at the start of a phase, then a point a quarter phase further")}],vector:[{mode:5.4,descr:_("Vector"),inN:2,input:_("Enter the starting and ending point of the vector")}]},
basic:{line:[{mode:0,descr:_("Lines"),inN:"list",input:_("Enter a list of points to connect with lines")}],lineseg:[{mode:.5,descr:_("Line segment"),inN:2,input:_("Enter the starting and ending point of the line segment")}],freehand:[{mode:.7,descr:_("Freehand"),inN:"list",input:_("Enter a list of points to connect with lines")}],dot:[{mode:1,descr:_("Solid dot"),inN:1,input:_("Enter the coordinates of the dot")}],opendot:[{mode:2,descr:_("Open dot"),inN:1,input:_("Enter the coordinates of the dot")}],
polygon:[{mode:0,descr:_("Polygon"),inN:"list",input:_("Enter a list of points for dots to connect with lines"),dotline:1}],closedpolygon:[{mode:0,descr:_("Polygon"),inN:"list",input:_("Enter a list of points for dots to connect with lines"),dotline:2}]}};h=[];D=[];k=[];for(v=0;v<b.length;v++)if(t[l].hasOwnProperty(b[v])){if(0==v)var R=t[l][b[v]][0].mode;for(y=0;y<t[l][b[v]].length;y++)k[t[l][b[v]][y].mode]=t[l][b[v]][y],h.push(t[l][b[v]][y].mode),w='<option value="'+t[l][b[v]][y].mode+'"',w+=' data-af="'+
b[v]+'">'+t[l][b[v]][y].descr+"</option>",D.push(w)}document.getElementById("a11ydrawnew"+c).innerHTML=D;g[c].defmode=R;g[c].inputmodes=h;g[c].selects=D;g[c].moderef=k;if(null==f&&n.hasOwnProperty(c)){for(v=0;v<n[c].length;v++)S(c,0,L(n[c][v],c));for(v=0;v<M[c].length;v++)S(c,1,L(M[c][v],c));for(v=0;v<K[c].length;v++)S(c,2,L(K[c][v],c));for(v=0;v<e[c].length;v++)S(c,z[c][v],L(e[c][v][0],c)+","+L(e[c][v][1],c));for(v=0;v<m[c].length;v++)S(c,P[c][v],L(m[c][v][0],c)+","+L(m[c][v][1],c)+","+L(m[c][v][2],
c))}else if(null!=f)for(v=0;v<f.length;v++)S(c,f[v][0],f[v][1].replace(/\[/g,"(").replace(/\]/g,")"))}function S(d,f,c){var b=g[d];f=f||document.getElementById("a11ydrawnew"+d).value;var l=c||"",t=b.el.getElementsByTagName("li").length+1;d=Z[d].disabled?" disabled ":"";html=t='<span class="sr-only draweln">'+_("Drawing element ")+t+"</span>";html+=b.moderef[f].descr+".<br/>";html+='<label><span class="a11ydrawinstr"></span><br/>';html+='<input type="text" value="'+l+'" data-n="'+b.moderef[f].inN+
'" '+d;html+='onblur="imathasDraw.updatea11ydraw(this)"/></label>';html+='<button type="button" class="imgbutton" onclick="imathasDraw.removea11ydraw(this)"'+d+">";html+=_("Remove")+" "+t+"</button>";l=u("<li>",{"class":"a11ydrawrow","data-mode":f}).html(html);u(b.el).append(l);l.find(".a11ydrawinstr").text(b.moderef[f].input);c||l.find("input").focus()}function L(d,f){var c=g[f];var b=(d[0]-c.imgborder)/c.pixperx+c.xmin;c=(c.imgheight-d[1]-c.imgborder)/c.pixpery+c.ymin;b=Math.round(100*b)/100;c=
Math.round(100*c)/100;return"("+b+","+c+")"}function O(d){"undefined"==typeof d&&(d=-1);for(var f in g)if(!(-1<d&&d!=f)){var c=g[f];if("a11y"==c.type){var b=[],l=[],t=[],h=[],D=[],k=[];u("#a11ydraw"+f).find(".a11ydrawrow").each(function(w,v){var y=u(v).find("input").val(),I=v.getAttribute("data-mode");k.push("["+I+',"'+y+'"]');y=y.replace(/[\(\)]/g,"").split(/\s*,\s*/);var J=[];for(w=1;w<y.length;w+=2){try{y[w-1]=eval(prepWithMath(mathjs(y[w-1])))}catch(R){y[w-1]=NaN}try{y[w]=eval(prepWithMath(mathjs(y[w])))}catch(R){y[w]=
NaN}y[w-1]=(y[w-1]-c.xmin)*c.pixperx+c.imgborder;y[w]=c.imgheight-(y[w]-c.ymin)*c.pixpery-c.imgborder;J.push(Math.round(y[w-1])+","+Math.round(y[w]))}1==I?l.push("("+J.join("),(")+")"):2==I?t.push("("+J.join("),(")+")"):1>I?b.push("("+J.join("),(")+")"):5<=I&&10>I&&2==J.length?h.push("("+I+","+J.join(",")+")"):10<=I&&3==J.length&&D.push("("+I+","+J.join(",")+")")});Z[f].value=b.join(";")+";;"+l.join(",")+";;"+t.join(",")+";;"+h.join(",")+";;"+D.join(",")+";;"+k.join(",");u(Z[f]).trigger("input").trigger("change")}}}
function ya(d,f,c,b,l,t,h,D,k,w,v,y,I,J,R){var Q=document.getElementById(f);if(u(Q).is(":hidden"))u(Q).on("mouseover.imathasdrawwait touchstart.imathasdrawwait",function(){u(Q).off("mouseover.imathasdrawwait touchstart.imathasdrawwait");gb(d)});Q.style.userSelect="none";Q.style.webkitUserSelect="none";Q.style.MozUserSelect="none";f=sa(Q);g[d]={type:"canvas",el:Q,left:f.x,top:f.y,width:Q.offsetWidth,height:Q.offsetHeight,xmin:l,xmax:t,ymin:h,ymax:D,imgborder:k,imgwidth:w,imgheight:v,mode:y,dotline:I};
"string"==typeof R&&-1!=R.indexOf(":")?(R=R.split(":"),g[d].snaptogridx=1*R[0],g[d].snaptogridy=1*R[1]):(g[d].snaptogridx=1*R,g[d].snaptogridy=1*R);g[d].pixperx=(w-2*k)/(t-l);g[d].pixpery=h==D?1:(v-2*k)/(D-h);Z[d]=document.getElementById(b);null==n[d]&&(n[d]=[]);null==M[d]&&(M[d]=[]);null==K[d]&&(K[d]=[]);null==e[d]&&(e[d]=[]);null==z[d]&&(z[d]=[]);null==m[d]&&(m[d]=[]);null==P[d]&&(P[d]=[]);ia[d]=J;c.match(/initPicture/)?(0==u(Q).closest(".drawcanvasholder").length&&(u(Q).removeClass("drawcanvas").wrap(u("<div>",
{"class":"drawcanvas",style:"position:relative;width:"+w+"px;height:"+v+"px"})).wrap(u("<div>",{"class":"drawcanvasholder",style:"position:absolute;top:0;left:0;z-index:2"})),u(Q).closest(".drawcanvas").prepend(u("<div>",{"class":"canvasbg",style:"position:absolute;top:0;left:0"}).append(u("<embed>",{"data-nomag":1,type:"image/svg+xml",align:"middle",width:w,height:v,script:c}).attr("width",w).attr("height",v)))),Ca[d]=null,c=a,a=d,B(),setTimeout(function(){window.drawPics(u(Q).closest(".drawcanvas")[0])},
30),a=c):""!==c?(Ca[d]=new Image,Ca[d].onload=function(){var hb=a;a=d;B();a=hb},Ca[d].src=c):(Ca[d]=null,c=a,a=d,B(),a=c)}function B(d,f){try{var c=g[a].el.getContext("2d")}catch(jc){Fb||(Fb=!0,alert("Your browser does not support drawing answer entry.  Please try again using Internet Explorer 6+ (Windows), FireFox 1.5+ (Win/Mac), Safari 1.3+ (Mac), Opera 9+ (Win/Mac), or Camino (Mac)"))}c.fillStyle="rgb(0,0,255)";c.lineWidth=2;c.strokeStyle="rgb(0,0,255)";c.clearRect(0,0,g[a].imgwidth,g[a].imgheight);
null!==Ca[a]&&c.drawImage(Ca[a],0,0);c.beginPath();for(var b=0;b<m[a].length;b++){var l=b%3;c.strokeStyle=Gb[l];c.fillStyle=Gb[l];var t=null,h=null,D=null,k=null,w=null;3==m[a][b].length?(h=m[a][b][1][0],k=m[a][b][1][1],D=m[a][b][2][0],w=m[a][b][2][1]):2==m[a][b].length?(h=m[a][b][1][0],k=m[a][b][1][1],D=d,w=f):H==b&&null!=d&&1==m[a][b].length&&(h=d,k=f);if(null!=D){c.save();c.fillStyle=dc[l];c.beginPath();if(10.2>=P[a][b]){h!=m[a][b][0][0]&&(t=(k-m[a][b][0][1])/(h-m[a][b][0][0]));if(1>Math.abs(h-
m[a][b][0][0])||100<Math.abs(t))c.moveTo(m[a][b][0][0],0),c.lineTo(m[a][b][0][0],g[a].imgheight),D>h?(c.lineTo(g[a].imgwidth,g[a].imgheight),c.lineTo(g[a].imgwidth,0)):(c.lineTo(0,g[a].imgheight),c.lineTo(0,0));else{var v=t*(D-h)+k,y=m[a][b][0][1]-t*m[a][b][0][0],I=m[a][b][0][1]+t*(g[a].imgwidth-m[a][b][0][0]);c.moveTo(0,y);c.lineTo(g[a].imgwidth,I);w>v?(c.lineTo(g[a].imgwidth,g[a].imgheight),c.lineTo(0,g[a].imgheight)):(c.lineTo(g[a].imgwidth,0),c.lineTo(0,0))}c.closePath()}else{var J=c,R=m[a][b][0][0],
Q=m[a][b][0][1],hb=h,Sa=k,Ja=D,rb=w,Ta=g[a].imgwidth,Ua=g[a].imgheight;J.beginPath();if(Sa==Q)J.moveTo(0,Sa),J.lineTo(Ta,Sa),rb<Q?(J.lineTo(Ta,0),J.lineTo(0,0)):(J.lineTo(Ta,Ua),J.lineTo(0,Ua));else{var ja=(Sa-Q)/((hb-R)*(hb-R)),Fa=-2*ja*R,sb=0;Sa>Q&&(sb=Ua);var Va=ja*R*R+Q-sb,Hb=Math.sqrt(Fa*Fa-4*ja*Va);Va+=sb;var ta=(-Fa-Hb)/(2*ja),Ka=ja*ta*ta+Fa*ta+Va,La=(-Fa+Hb)/(2*ja),ib=Ka;if(La<ta){var ec=ta;ta=La;La=ec}var jb=2*ja*(ta-R),Ib=Ka-jb*ta,Jb=-jb,tb=(Ib-(ib-Jb*La))/(Jb-jb),Kb=jb*tb+Ib;if(0>ja&&rb<
ja*Ja*Ja+Fa*Ja+Va||0<ja&&rb>ja*Ja*Ja+Fa*Ja+Va)J.moveTo(ta,Ka),J.quadraticCurveTo(tb,Kb,La,ib);else{var ub=Ua;2>Math.abs(Ka-Ua)&&(ub=0);J.moveTo(0,Ka);J.lineTo(ta,Ka);J.quadraticCurveTo(tb,Kb,La,ib);J.lineTo(Ta,ib);J.lineTo(Ta,ub);J.lineTo(0,ub)}}J.closePath()}c.fill();c.restore()}c.beginPath();if(null!=h)if(10.2>=P[a][b])h!=m[a][b][0][0]&&(t=(k-m[a][b][0][1])/(h-m[a][b][0][0])),1>Math.abs(h-m[a][b][0][0])||100<Math.abs(t)?10.2==P[a][b]?null!=q&&10<=q.mode&&11>q.mode&&q.num==b&&0==q.subnum?(c.dashedLine(m[a][b][1][0],
m[a][b][1][1],m[a][b][1][0],g[a].imgheight),c.dashedLine(m[a][b][1][0],m[a][b][1][1],m[a][b][1][0],0)):(c.dashedLine(m[a][b][0][0],m[a][b][0][1],m[a][b][0][0],g[a].imgheight),c.dashedLine(m[a][b][0][0],m[a][b][0][1],m[a][b][0][0],0)):(c.moveTo(m[a][b][0][0],0),c.lineTo(m[a][b][0][0],g[a].imgheight),c.stroke()):(y=m[a][b][0][1]-t*m[a][b][0][0],I=m[a][b][0][1]+t*(g[a].imgwidth-m[a][b][0][0]),10.2==P[a][b]?null!=q&&10<=q.mode&&11>q.mode&&q.num==b&&0==q.subnum?(c.dashedLine(m[a][b][1][0],m[a][b][1][1],
g[a].imgwidth,I),c.dashedLine(m[a][b][1][0],m[a][b][1][1],0,y)):(c.dashedLine(m[a][b][0][0],m[a][b][0][1],g[a].imgwidth,I),c.dashedLine(m[a][b][0][0],m[a][b][0][1],0,y)):(c.moveTo(0,y),c.lineTo(g[a].imgwidth,I),c.stroke()));else if(10.3==P[a][b]){if(h!=m[a][b][0][0])if(k==m[a][b][0][1])c.moveTo(0,k),c.lineTo(g[a].imgwidth,k);else{var G=(k-m[a][b][0][1])/((h-m[a][b][0][0])*(h-m[a][b][0][0]));if(k>m[a][b][0][1])var V=Math.sqrt((g[a].imgheight-m[a][b][0][1])/G)+m[a][b][0][0],ka=-1*Math.sqrt((g[a].imgheight-
m[a][b][0][1])/G)+m[a][b][0][0],Wa=m[a][b][0][1]-(g[a].imgheight-m[a][b][0][1]),la=g[a].imgheight;else V=Math.sqrt((0-m[a][b][0][1])/G)+m[a][b][0][0],ka=-1*Math.sqrt((0-m[a][b][0][1])/G)+m[a][b][0][0],Wa=2*m[a][b][0][1],la=0;var Da=V+2/3*(m[a][b][0][0]-V),Ea=la+2/3*(Wa-la),Xa=Da+(ka-V)/3,Ya=Ea;c.moveTo(V,la);c.bezierCurveTo(Da,Ea,Xa,Ya,ka,la)}c.stroke()}else if(h!=m[a][b][0][0]){var Ga=c,za=m[a][b][0][0],Ma=m[a][b][0][1],Lb=h,Na=k,Mb=g[a].imgwidth,fc=g[a].imgheight;if(Na==Ma)Ga.moveTo(0,Na),Ga.dashedLine(0,
Na,Mb,Na);else{var ma=(Na-Ma)/((Lb-za)*(Lb-za)),Oa=-2*ma*za,vb=0;Na>Ma&&(vb=fc);var kb=ma*za*za+Ma-vb,Nb=Math.sqrt(Oa*Oa-4*ma*kb);kb+=vb;var lb=(-Oa-Nb)/(2*ma),mb=(-Oa+Nb)/(2*ma);if(mb<lb){var gc=lb;lb=mb;mb=gc}for(var T=za,Ha=Ma,Za=0;T>lb-5&&-5<T;)0==Za%2?Ga.moveTo(T,Ha):Ga.lineTo(T,Ha),T-=Math.min(Math.sqrt(64/(1+Math.pow(2*ma*(T-za),2))),Math.sqrt(8/Math.abs(ma))),Ha=ma*T*T+Oa*T+kb,Za++;T=za;Ha=Ma;for(Za=0;T<mb+5&&T<Mb+5;)0==Za%2?Ga.moveTo(T,Ha):Ga.lineTo(T,Ha),T+=Math.min(Math.sqrt(64/(1+Math.pow(2*
ma*(T-za),2))),Math.sqrt(8/Math.abs(ma))),Ha=ma*T*T+Oa*T+kb,Za++}Ga.stroke()}c.beginPath();for(var C=0;C<m[a][b].length;C++)2==C?(c.arc(m[a][b][C][0],m[a][b][C][1],4,0,2*Math.PI,!0),c.fill()):c.fillRect(m[a][b][C][0]-3,m[a][b][C][1]-3,6,6);1==m[a][b].length&&null!=h&&c.fillRect(h-3,k-3,6,6);c.beginPath()}c.fillStyle="rgb(0,0,255)";c.lineWidth=1==ia[a]?4:2;c.strokeStyle="rgb(0,0,255)";for(b=0;b<e[a].length;b++){if(5<=z[a][b]&&6>z[a][b]){if(k=h=t=null,2==e[a][b].length?(h=e[a][b][1][0],k=e[a][b][1][1]):
A==b&&null!=d&&1==e[a][b].length&&(h=d,k=f),null!=h)if(5.3==z[a][b]||5.4==z[a][b]){if(c.moveTo(e[a][b][0][0],e[a][b][0][1]),c.lineTo(h,k),5.4==z[a][b]){var ba=[h-e[a][b][0][0],k-e[a][b][0][1]];var wb=Math.sqrt(ba[0]*ba[0]+ba[1]*ba[1]);if(1E-4<wb){ba=[ba[0]/wb,ba[1]/wb];var nb=[-ba[1],ba[0]];c.moveTo(h-15*ba[0]-4*nb[0],k-15*ba[1]-5*nb[1]);c.lineTo(h,k);c.moveTo(h-15*ba[0]+4*nb[0],k-15*ba[1]+5*nb[1]);c.lineTo(h,k)}}}else h!=e[a][b][0][0]&&(t=(k-e[a][b][0][1])/(h-e[a][b][0][0])),1>Math.abs(h-e[a][b][0][0])||
100<Math.abs(t)?5.2==z[a][b]?(c.moveTo(e[a][b][0][0],e[a][b][0][1]),k>e[a][b][0][1]?c.lineTo(e[a][b][0][0],g[a].imgheight):c.lineTo(e[a][b][0][0],0)):(c.moveTo(e[a][b][0][0],0),c.lineTo(e[a][b][0][0],g[a].imgheight)):(y=e[a][b][0][1]-t*e[a][b][0][0],I=e[a][b][0][1]+t*(g[a].imgwidth-e[a][b][0][0]),y=e[a][b][0][1]-t*e[a][b][0][0],I=e[a][b][0][1]+t*(g[a].imgwidth-e[a][b][0][0]),5.2==z[a][b]?(c.moveTo(e[a][b][0][0],e[a][b][0][1]),h>e[a][b][0][0]?c.lineTo(g[a].imgwidth,I):c.lineTo(0,y)):(c.moveTo(0,y),
c.lineTo(g[a].imgwidth,I)))}else if(6==z[a][b]||6.1==z[a][b]){if(h=k=null,2==e[a][b].length?(h=e[a][b][1][0],k=e[a][b][1][1]):A==b&&null!=d&&1==e[a][b].length&&(h=d,k=f),null!=h)if(6==z[a][b])k==e[a][b][0][1]?(c.moveTo(0,k),c.lineTo(g[a].imgwidth,k)):h==e[a][b][0][0]?(c.moveTo(h,e[a][b][0][1]),k>e[a][b][0][1]?c.lineTo(h,g[a].imgheight):c.lineTo(h,0)):(G=(k-e[a][b][0][1])/((h-e[a][b][0][0])*(h-e[a][b][0][0])),k>e[a][b][0][1]?(V=Math.sqrt((g[a].imgheight-e[a][b][0][1])/G)+e[a][b][0][0],ka=-1*Math.sqrt((g[a].imgheight-
e[a][b][0][1])/G)+e[a][b][0][0],Wa=e[a][b][0][1]-(g[a].imgheight-e[a][b][0][1]),la=g[a].imgheight):(V=Math.sqrt((0-e[a][b][0][1])/G)+e[a][b][0][0],ka=-1*Math.sqrt((0-e[a][b][0][1])/G)+e[a][b][0][0],Wa=2*e[a][b][0][1],la=0),Da=V+2/3*(e[a][b][0][0]-V),Ea=la+2/3*(Wa-la),Xa=Da+(ka-V)/3,Ya=Ea,c.moveTo(V,la),c.bezierCurveTo(Da,Ea,Xa,Ya,ka,la));else if(6.1==z[a][b])if(h==e[a][b][0][0])c.moveTo(h,0),c.lineTo(h,g[a].imgheight);else if(k==e[a][b][0][1])c.moveTo(e[a][b][0][0],k),h>e[a][b][0][0]?c.lineTo(g[a].imgwidth,
k):c.lineTo(0,k);else{G=(h-e[a][b][0][0])/((k-e[a][b][0][1])*(k-e[a][b][0][1]));if(h>e[a][b][0][0]){V=Math.sqrt((g[a].imgwidth-e[a][b][0][0])/G)+e[a][b][0][1];ka=-1*Math.sqrt((g[a].imgwidth-e[a][b][0][0])/G)+e[a][b][0][1];var Ob=e[a][b][0][0]-(g[a].imgwidth-e[a][b][0][0]),$a=g[a].imgwidth}else V=Math.sqrt((0-e[a][b][0][0])/G)+e[a][b][0][1],ka=-1*Math.sqrt((0-e[a][b][0][0])/G)+e[a][b][0][1],Ob=2*e[a][b][0][0],$a=0;Ea=V+2/3*(e[a][b][0][1]-V);Da=$a+2/3*(Ob-$a);Ya=Ea+(ka-V)/3;Xa=Da;c.moveTo($a,V);c.bezierCurveTo(Da,
Ea,Xa,Ya,$a,ka)}}else if(6.5==z[a][b]){if(h=k=null,2==e[a][b].length?(h=e[a][b][1][0],k=e[a][b][1][1]):A==b&&null!=d&&1==e[a][b].length&&(h=d,k=f),null!=h&&h!=e[a][b][0][0])if(k==e[a][b][0][1])c.moveTo(e[a][b][0][0],k),h>e[a][b][0][0]?c.lineTo(g[a].imgwidth,k):c.lineTo(0,k);else{var xb=h<e[a][b][0][0]?-1:1;G=(k-e[a][b][0][1])/Math.sqrt(xb*(h-e[a][b][0][0]));c.moveTo(e[a][b][0][0],e[a][b][0][1]);p=e[a][b][0][0];r=e[a][b][0][1];do p+=3*xb,c.lineTo(p,G*Math.sqrt(xb*(p-e[a][b][0][0]))+e[a][b][0][1]);
while(0<p&&p<g[a].imgwidth&&0<r&&r<g[a].imgheight)}}else if(6.3==z[a][b]){if(h=k=null,2==e[a][b].length?(h=e[a][b][1][0],k=e[a][b][1][1]):A==b&&null!=d&&1==e[a][b].length&&(h=d,k=f),null!=h&&h!=e[a][b][0][0])if(k==e[a][b][0][1])c.moveTo(0,k),c.lineTo(g[a].imgwidth,k);else{G=(k-e[a][b][0][1])/safepow(h-e[a][b][0][0],3);for(var r=0,p=0;p<g[a].imgwidth+4;p+=1)r=G*safepow(p-e[a][b][0][0],3)+e[a][b][0][1],-100>r&&(r=-100),r>g[a].imgheight+100&&(r=g[a].imgheight+100),0==p?c.moveTo(p,r):c.lineTo(p,r)}}else if(6.6==
z[a][b]){if(h=k=null,2==e[a][b].length?(h=e[a][b][1][0],k=e[a][b][1][1]):A==b&&null!=d&&1==e[a][b].length&&(h=d,k=f),null!=h&&h!=e[a][b][0][0])if(k==e[a][b][0][1])c.moveTo(0,k),c.lineTo(g[a].imgwidth,k);else for(G=(k-e[a][b][0][1])/safepow(h-e[a][b][0][0],1/3),p=r=0;p<g[a].imgwidth+4;p+=1)r=G*safepow(p-e[a][b][0][0],1/3)+e[a][b][0][1],-100>r&&(r=-100),r>g[a].imgheight+100&&(r=g[a].imgheight+100),0==p?c.moveTo(p,r):c.lineTo(p,r)}else if(7<=z[a][b]&&8>z[a][b]){if(h=k=null,2==e[a][b].length?(h=e[a][b][1][0],
k=e[a][b][1][1]):A==b&&null!=d&&1==e[a][b].length&&(h=d,k=f),null!=h&&(h!=e[a][b][0][0]||k!=e[a][b][0][1]))if(7==z[a][b])c.arc(e[a][b][0][0],e[a][b][0][1],Math.sqrt((h-e[a][b][0][0])*(h-e[a][b][0][0])+(k-e[a][b][0][1])*(k-e[a][b][0][1])),0,2*Math.PI,!0);else if(7.2==z[a][b]){var Pb=Math.abs(h-e[a][b][0][0]),Qb=Math.abs(k-e[a][b][0][1]);if(A==b||null!=q&&q.num==b)c.strokeStyle="rgb(0,255,255)",c.lineWidth=1,c.dashedLine(h,k,h-2*(h-e[a][b][0][0]),k,5),c.dashedLine(h,k,h,k-2*(k-e[a][b][0][1]),5),c.dashedLine(h,
k-2*(k-e[a][b][0][1]),h-2*(h-e[a][b][0][0]),k-2*(k-e[a][b][0][1]),5),c.dashedLine(h-2*(h-e[a][b][0][0]),k,h-2*(h-e[a][b][0][0]),k-2*(k-e[a][b][0][1]),5),c.lineWidth=2;c.strokeStyle="rgb(0,0,255)";c.save();c.beginPath();c.translate(e[a][b][0][0]-Pb,e[a][b][0][1]-Qb);c.scale(Pb,Qb);c.arc(1,1,1,0,2*Math.PI,!1);c.restore()}else if(7.4==z[a][b]){var na=Math.abs(h-e[a][b][0][0]),oa=Math.abs(k-e[a][b][0][1]),Aa=Math.abs(oa/na);c.strokeStyle="rgb(0,200,0)";c.dashedLine(e[a][b][0][0],e[a][b][0][1],g[a].imgwidth,
e[a][b][0][1]+Aa*(g[a].imgwidth-e[a][b][0][0]));c.dashedLine(e[a][b][0][0],e[a][b][0][1],g[a].imgwidth,e[a][b][0][1]-Aa*(g[a].imgwidth-e[a][b][0][0]));c.dashedLine(e[a][b][0][0],e[a][b][0][1],0,e[a][b][0][1]-Aa*e[a][b][0][0]);c.dashedLine(e[a][b][0][0],e[a][b][0][1],0,e[a][b][0][1]+Aa*e[a][b][0][0]);if(A==b||null!=q&&q.num==b)c.strokeStyle="rgb(0,255,255)",c.lineWidth=1,c.dashedLine(h,k,h-2*(h-e[a][b][0][0]),k,5),c.dashedLine(h,k,h,k-2*(k-e[a][b][0][1]),5),c.dashedLine(h,k-2*(k-e[a][b][0][1]),h-2*
(h-e[a][b][0][0]),k-2*(k-e[a][b][0][1]),5),c.dashedLine(h-2*(h-e[a][b][0][0]),k,h-2*(h-e[a][b][0][0]),k-2*(k-e[a][b][0][1]),5),c.lineWidth=2;c.beginPath();c.strokeStyle="rgb(0,0,255)";for(p=0;p<g[a].imgwidth+4;p+=3)r=e[a][b][0][1]+Math.sqrt((Math.pow(p-e[a][b][0][0],2)/(na*na)+1)*oa*oa),-100>r&&(r=-100),r>g[a].imgheight+100&&(r=g[a].imgheight+100),0==p?c.moveTo(p,r):c.lineTo(p,r);c.stroke();c.beginPath();for(p=0;p<g[a].imgwidth+4;p+=3)r=e[a][b][0][1]-Math.sqrt((Math.pow(p-e[a][b][0][0],2)/(na*na)+
1)*oa*oa),-100>r&&(r=-100),r>g[a].imgheight+100&&(r=g[a].imgheight+100),0==p?c.moveTo(p,r):c.lineTo(p,r)}else if(7.5==z[a][b]){oa=Math.abs(h-e[a][b][0][0]);na=Math.abs(k-e[a][b][0][1]);Aa=Math.abs(na/oa);c.strokeStyle="rgb(0,200,0)";c.dashedLine(e[a][b][0][0],e[a][b][0][1],g[a].imgwidth,e[a][b][0][1]+Aa*(g[a].imgwidth-e[a][b][0][0]));c.dashedLine(e[a][b][0][0],e[a][b][0][1],g[a].imgwidth,e[a][b][0][1]-Aa*(g[a].imgwidth-e[a][b][0][0]));c.dashedLine(e[a][b][0][0],e[a][b][0][1],0,e[a][b][0][1]-Aa*e[a][b][0][0]);
c.dashedLine(e[a][b][0][0],e[a][b][0][1],0,e[a][b][0][1]+Aa*e[a][b][0][0]);if(A==b||null!=q&&q.num==b)c.strokeStyle="rgb(0,255,255)",c.lineWidth=1,c.dashedLine(h,k,h-2*(h-e[a][b][0][0]),k,5),c.dashedLine(h,k,h,k-2*(k-e[a][b][0][1]),5),c.dashedLine(h,k-2*(k-e[a][b][0][1]),h-2*(h-e[a][b][0][0]),k-2*(k-e[a][b][0][1]),5),c.dashedLine(h-2*(h-e[a][b][0][0]),k,h-2*(h-e[a][b][0][0]),k-2*(k-e[a][b][0][1]),5),c.lineWidth=2;c.beginPath();c.strokeStyle="rgb(0,0,255)";for(r=0;r<g[a].imgwidth+4;r+=3)p=e[a][b][0][0]+
Math.sqrt((Math.pow(r-e[a][b][0][1],2)/(na*na)+1)*oa*oa),-100>p&&(p=-100),p>g[a].imgwidth+100&&(p=g[a].imgwidth+100),0==r?c.moveTo(p,r):c.lineTo(p,r);c.stroke();c.beginPath();for(r=0;r<g[a].imgwidth+4;r+=3)p=e[a][b][0][0]-Math.sqrt((Math.pow(r-e[a][b][0][1],2)/(na*na)+1)*oa*oa),-100>p&&(p=-100),p>g[a].imgwidth+100&&(p=g[a].imgwidth+100),0==r?c.moveTo(p,r):c.lineTo(p,r)}}else if(8==z[a][b])k=h=t=null,2==e[a][b].length?(h=e[a][b][1][0],k=e[a][b][1][1]):A==b&&null!=d&&1==e[a][b].length&&(h=d,k=f),null!=
h&&(h!=e[a][b][0][0]&&(t=(k-e[a][b][0][1])/(h-e[a][b][0][0]),h<e[a][b][0][0]&&(t*=-1)),1>Math.abs(h-e[a][b][0][0])||100<Math.abs(t)?(c.moveTo(e[a][b][0][0],e[a][b][0][1]),k>e[a][b][0][1]?c.lineTo(e[a][b][0][0],g[a].imgheight):c.lineTo(e[a][b][0][0],0)):(y=e[a][b][0][1]+t*e[a][b][0][0],I=e[a][b][0][1]+t*(g[a].imgwidth-e[a][b][0][0]),c.moveTo(0,y),c.lineTo(e[a][b][0][0],e[a][b][0][1]),c.lineTo(g[a].imgwidth,I)));else if(8.3==z[a][b]){if(h=k=null,2==e[a][b].length?(h=e[a][b][1][0],k=e[a][b][1][1]):A==
b&&null!=d&&1==e[a][b].length&&(h=d,k=f),null!=h&&h!=e[a][b][0][0])if(k==e[a][b][0][1])c.moveTo(0,k),c.lineTo(g[a].imgwidth,k);else{var yb=g[a].ymax*g[a].pixpery+g[a].imgborder,Rb=yb-e[a][b][0][1],Pa=yb-k;if(0<Rb*Pa&&h!=e[a][b][0][0]){var pa=safepow(Pa/Rb,1/(h-e[a][b][0][0]));G=Pa/safepow(pa,h);c.moveTo(e[a][b][0][0],e[a][b][0][1]);for(p=r=0;p<g[a].imgwidth+4;p+=3)r=yb-G*safepow(pa,p),-100>r&&(r=-100),r>g[a].imgheight+100&&(r=g[a].imgheight+100),0==p?c.moveTo(p,r):c.lineTo(p,r)}}}else if(8.4==z[a][b]){if(h=
k=null,2==e[a][b].length?(h=e[a][b][1][0],k=e[a][b][1][1]):A==b&&null!=d&&1==e[a][b].length&&(h=d,k=f),null!=h&&h!=e[a][b][0][0]&&k!=e[a][b][0][1]){var zb=-g[a].xmin*g[a].pixperx+g[a].imgborder,Sb=zb-e[a][b][0][0],Qa=zb-h;if(0<Sb*Qa&&k!=e[a][b][0][1])for(pa=safepow(Qa/Sb,1/(k-e[a][b][0][1])),G=Qa/safepow(pa,k),c.moveTo(e[a][b][0][0],e[a][b][0][1]),r=r=0;r<g[a].imgheight+4;r+=3)p=zb-G*safepow(pa,r),-100>p&&(p=-100),p>g[a].imgwidth+100&&(p=g[a].imgwidth+100),0==r?c.moveTo(p,r):c.lineTo(p,r)}}else if(8.5==
z[a][b]){D=w=h=k=null;3==e[a][b].length?(h=e[a][b][1][0],k=e[a][b][1][1],D=e[a][b][2][0],w=e[a][b][2][1]):2==e[a][b].length?(h=e[a][b][1][0],k=e[a][b][1][1],D=d,w=f):A==b&&null!=d&&1==e[a][b].length&&(h=d,k=f);var ab=e[a][b][0][1];c.strokeStyle="rgb(0,200,0)";c.dashedLine(5,ab,g[a].imgwidth,ab);c.beginPath();c.strokeStyle="rgb(0,0,255)";if(null!=D&&D!=h)if(w==k)c.moveTo(0,w),c.lineTo(g[a].imgwidth,w);else{Pa=ab-k;var Ab=ab-w;if(0<Pa*Ab&&D!=h)for(pa=safepow(Ab/Pa,1/(D-h)),G=Ab/safepow(pa,D),c.moveTo(h,
k),p=r=0;p<g[a].imgwidth+4;p+=3)r=ab-G*safepow(pa,p),-100>r&&(r=-100),r>g[a].imgheight+100&&(r=g[a].imgheight+100),0==p?c.moveTo(p,r):c.lineTo(p,r)}}else if(8.6==z[a][b]){D=w=h=k=null;3==e[a][b].length?(h=e[a][b][1][0],k=e[a][b][1][1],D=e[a][b][2][0],w=e[a][b][2][1]):2==e[a][b].length?(h=e[a][b][1][0],k=e[a][b][1][1],D=d,w=f):A==b&&null!=d&&1==e[a][b].length&&(h=d,k=f);var bb=e[a][b][0][0];c.strokeStyle="rgb(0,200,0)";c.dashedLine(bb,5,bb,g[a].imgheight);c.beginPath();c.strokeStyle="rgb(0,0,255)";
if(null!=D&&D!=h&&w!=k){Qa=h-bb;var Bb=D-bb;if(0<Qa*Bb)for(pa=safepow(Bb/Qa,1/(w-k)),G=Bb/safepow(pa,w),c.moveTo(h,k),r=p=0;r<g[a].imgheight+4;r+=3)p=bb+G*safepow(pa,r),-100>p&&(p=-100),p>g[a].imgwidth+100&&(p=g[a].imgwidth+100),0==r?c.moveTo(p,r):c.lineTo(p,r)}}else if(8.2==z[a][b]){if(h=k=null,2==e[a][b].length?(h=e[a][b][1][0],k=e[a][b][1][1]):A==b&&null!=d&&1==e[a][b].length&&(h=d,k=f),c.strokeStyle="rgb(0,200,0)",c.dashedLine(5,e[a][b][0][1],g[a].imgwidth,e[a][b][0][1]),c.dashedLine(e[a][b][0][0],
5,e[a][b][0][0],g[a].imgheight),c.beginPath(),c.strokeStyle="rgb(0,0,255)",null!=h&&h!=e[a][b][0][0]&&k!=e[a][b][0][1]){G=(k-e[a][b][0][1])*(h-e[a][b][0][0]);for(p=e[a][b][0][0]-1;-4<p;p-=3)r=G/(p-e[a][b][0][0])+e[a][b][0][1],-100>r&&(r=-100),r>g[a].imgheight+100&&(r=g[a].imgheight+100),p==e[a][b][0][0]-1?c.moveTo(p,r):c.lineTo(p,r);for(p=e[a][b][0][0]+1;p<g[a].imgwidth+4;p+=3)r=G/(p-e[a][b][0][0])+e[a][b][0][1],-100>r&&(r=-100),r>g[a].imgheight+100&&(r=g[a].imgheight+100),p==e[a][b][0][0]+1?c.moveTo(p,
r):c.lineTo(p,r);c.stroke()}}else if(9==z[a][b]||9.1==z[a][b])if(h=k=null,2==e[a][b].length?(h=e[a][b][1][0],k=e[a][b][1][1]):A==b&&null!=d&&1==e[a][b].length&&(h=d,k=f),null!=h&&h!=e[a][b][0][0])if(k==e[a][b][0][1])c.moveTo(0,k),c.lineTo(g[a].imgwidth,k);else{if(9==z[a][b]){var Tb=-1*Math.abs(k-e[a][b][0][1])/2,Ub=(k+e[a][b][0][1])/2;G=Math.PI/Math.abs(h-e[a][b][0][0]);var Vb=k<e[a][b][0][1]?h:e[a][b][0][0]}else 9.1==z[a][b]&&(Tb=-1*Math.abs(k-e[a][b][0][1]),Ub=e[a][b][0][1],G=.5*Math.PI/Math.abs(h-
e[a][b][0][0]),Vb=k<e[a][b][0][1]?h:h+2*Math.abs(h-e[a][b][0][0]));for(p=r=0;p<g[a].imgwidth+4;p+=3)r=Tb*Math.cos(G*(p-Vb))+Ub,0==p?c.moveTo(p,r):c.lineTo(p,r)}c.stroke();c.beginPath()}if(null===A&&Cb.hasOwnProperty(g[a].mode)){c.strokeStyle="rgb(200,200,200)";if(8.5==g[a].mode)c.dashedLine(5,f,g[a].imgwidth,f);else if(8.6==g[a].mode)c.dashedLine(d,5,d,g[a].imgwidth);else if(8.2==g[a].mode)c.dashedLine(5,f,g[a].imgwidth,f),c.dashedLine(d,5,d,g[a].imgheight);else if(7.4==g[a].mode||7.5==g[a].mode)c.dashedLine(d,
f,g[a].imgwidth,f+(g[a].imgwidth-d)),c.dashedLine(d,f,g[a].imgwidth,f-(g[a].imgwidth-d)),c.dashedLine(d,f,0,f-d),c.dashedLine(d,f,0,f+d);c.beginPath();c.strokeStyle="rgb(0,0,255)"}c.fillStyle="rgba(0,0,255,.5)";for(b=0;b<n[a].length;b++){c.beginPath();for(C=0;C<n[a][b].length;C++)if(0==C){c.moveTo(n[a][b][C][0],n[a][b][C][1]);var qa=n[a][b][C][0];var Ba=n[a][b][C][1]}else{c.lineTo(n[a][b][C][0],n[a][b][C][1]);var fa=n[a][b][C][0];var ua=n[a][b][C][1]}b==x&&null!=d&&(c.lineTo(d,f),fa=d,ua=f);var X=
.02*g[a].imgwidth;1==ia[a]&&fa>.98*g[a].imgwidth?(c.moveTo(fa,ua),c.lineTo(fa-X,ua+X),c.moveTo(fa,ua),c.lineTo(fa-X,ua-X)):1==ia[a]&&qa>.98*g[a].imgwidth&&(c.moveTo(qa,Ba),c.lineTo(qa-X,Ba+X),c.moveTo(qa,Ba),c.lineTo(qa-X,Ba-X));1==ia[a]&&fa<.02*g[a].imgwidth?(c.moveTo(fa,ua),c.lineTo(fa+X,ua+X),c.moveTo(fa,ua),c.lineTo(fa+X,ua-X)):1==ia[a]&&qa<.02*g[a].imgwidth&&(c.moveTo(qa,Ba),c.lineTo(qa+X,Ba+X),c.moveTo(qa,Ba),c.lineTo(qa+X,Ba-X));c.stroke();if(1<g[a].dotline&&!(1>n[a][b].length-1)&&25>Math.pow(fa-
qa,2)+Math.pow(ua-Ba,2)){c.moveTo(n[a][b][0][0],n[a][b][0][1]);for(C=1;C<n[a][b].length;C++)c.lineTo(n[a][b][C][0],n[a][b][C][1]);c.closePath();c.fill()}}c.fillStyle="rgb(0,0,255)";c.beginPath();for(b=0;b<M[a].length;b++)c.moveTo(M[a][b][0]+5,M[a][b][1]),c.arc(M[a][b][0],M[a][b][1],5,0,2*Math.PI,!0);c.fill();if(0<g[a].dotline){c.beginPath();for(b=0;b<n[a].length;b++)for(C=0;C<n[a][b].length;C++)if(0==C||25<Math.pow(n[a][b][C][0]-n[a][b][C-1][0],2)+Math.pow(n[a][b][C][1]-n[a][b][C-1][1],2))c.moveTo(n[a][b][C][0]+
5,n[a][b][C][1]),c.arc(n[a][b][C][0],n[a][b][C][1],5,0,2*Math.PI,!0);c.fill()}c.fillStyle="rgb(255,255,255)";c.beginPath();for(b=0;b<K[a].length;b++)c.moveTo(K[a][b][0]+5,K[a][b][1]),c.arc(K[a][b][0],K[a][b][1],4,0,2*Math.PI,!0);3>g[a].mode?c.fill():c.stroke();c.lineWidth=2;c.beginPath();for(b=0;b<K[a].length;b++)c.moveTo(K[a][b][0]+5,K[a][b][1]),c.arc(K[a][b][0],K[a][b][1],4,0,2*Math.PI,!0);c.stroke();for(b=0;b<e[a].length;b++)if(z[a][b]==g[a].mode){c.fillStyle="rgb(255,0,0)";for(C=0;C<e[a][b].length;C++)c.fillRect(e[a][b][C][0]-
3,e[a][b][C][1]-3,6,6);e[a][b].length<cb[g[a].mode]&&null!=d&&A==b&&c.fillRect(d-3,f-3,6,6);c.fillStyle="rgb(0,0,255)"}for(var Y="",ob=[],E=0;E<n[a].length;E++){ob=0==g[a].dotline?pathsimplify(n[a][E]):n[a][E];0!=E&&(Y+=";");for(var va=0;va<ob.length;va++)0!=va&&(Y+=","),Y+="("+ob[va][0]+","+ob[va][1]+")"}Y+=";;";for(E=0;E<M[a].length;E++)0!=E&&(Y+=","),Y+="("+M[a][E][0]+","+M[a][E][1]+")";Y+=";;";for(E=0;E<K[a].length;E++)0!=E&&(Y+=","),Y+="("+K[a][E][0]+","+K[a][E][1]+")";Y+=";;";var Wb=[],Db="";
for(E=0;E<e[a].length;E++)if(e[a][E].length==cb[z[a][E]]){Db="("+z[a][E];for(va=0;va<e[a][E].length;va++)Db+=","+e[a][E][va][0]+","+e[a][E][va][1];Wb.push(Db+")")}Y+=Wb.join(",");Y+=";;";var Xb=[];for(E=0;E<m[a].length;E++)2<m[a][E].length&&Xb.push("("+P[a][E]+","+m[a][E][0][0]+","+m[a][E][0][1]+","+m[a][E][1][0]+","+m[a][E][1][1]+","+m[a][E][2][0]+","+m[a][E][2][1]+")");Y+=Xb.join(",");if(Z[a].value!=Y){var hc=""!=Z[a].value||";;;;;;;;"!=Y;Z[a].value=Y;hc&&u(Z[a]).trigger("input").trigger("change")}}
function ra(d,f){1==d?M[a].splice(f,1):2==d?K[a].splice(f,1):0<=d&&1>d?n[a].splice(f,1):5<=d&&10>d?(e[a].splice(f,1),z[a].splice(f,1),A=null):10<=d&&11>d&&(m[a].splice(f,1),P[a].splice(f,1),H=null);B()}function aa(d){ic++;db();if(ha&&1<d.originalEvent.touches.length)return eb=!0,u(document).on("touchend.imathasdraw",ca),!0;ha?(window.clearTimeout(Yb),u(document).off("mousemove.imathasdraw"),u(".drawcanvas").on("touchstart.imathasdraw",function(b){ha=!0;aa(b)}),u(".drawcanvas").on("touchmove.imathasdraw",
wa),u(document).on("touchend.imathasdraw",ca),u(document).on("touchcancel.imathasdraw",ca)):(u(document).on("mousemove.imathasdraw",wa),u(document).on("mouseup.imathasdraw",ca));var f=da(d);if(null==a||null==x&&null==A&&null==H)for(i in g)if(!u(g[i].el).is(":hidden")){var c=sa(g[i].el);if(c.x<f.x&&c.x+g[i].width>f.x&&c.y<f.y&&c.y+g[i].height>f.y&&d.target==g[i].el){a=i;break}}if(null!=a&&!Z[a].disabled)if(d.preventDefault(),xa=!0,c=sa(g[a].el),d={x:f.x-c.x,y:f.y-c.y},-1<d.x&&d.x<g[a].width&&-1<d.y&&
d.y<g[a].height){0<g[a].snaptogridx&&(d=ea(d,a));1==ia[a]&&(d.y=g[a].imgheight/2);f=W(a,d);if(null!=f){if(-1==g[a].mode){ra(f[0],f[1]);return}null!=x&&1>f[0]&&x!=f[1]?f=null:null!=A&5<=f[0]&&10>f[0]&&A!=f[1]?f=null:null!=H&&10<=f[0]&&11>f[0]&&H!=f[1]&&(f=null)}null==f?(N("pendown"),1==g[a].mode?(M[a].push([d.x,d.y]),q={mode:1,num:M[a].length-1}):2==g[a].mode?(K[a].push([d.x,d.y]),q={mode:2,num:K[a].length-1}):0==g[a].mode||.7==g[a].mode?null==x?(n[a].push([[d.x,d.y]]),x=n[a].length-1):n[a][x].push([d.x,
d.y]):.5==g[a].mode?null==x?(n[a].push([[d.x,d.y]]),x=n[a].length-1):(n[a][x].push([d.x,d.y]),q=x=null):5<=g[a].mode&&10>g[a].mode?null==A?(e[a].push([[d.x,d.y]]),A=e[a].length-1,z[a][A]=g[a].mode,xa=!1):(e[a][A].push([d.x,d.y]),e[a][A].length==cb[g[a].mode]&&(q={mode:g[a].mode,num:A,subnum:1},A=null)):10<=g[a].mode&&11>g[a].mode&&(null==H?(m[a].push([[d.x,d.y]]),H=m[a].length-1,P[a][H]=g[a].mode,xa=!1):(m[a][H].push([d.x,d.y]),2==m[a][H].length?q={mode:g[a].mode,num:H,subnum:1}:3==m[a][H].length&&
(q={mode:g[a].mode,num:H,subnum:2},H=null)))):0==f[0]||.5==f[0]?null==x?(N("move"),q={mode:g[a].mode,num:f[1],subnum:f[2]},pb=n[a][f[1]][f[2]],f[2]==n[a][f[1]].length-1&&0==g[a].mode?x=f[1]:0==f[2]&&0==g[a].mode&&(x=f[1],n[a][x].reverse(),q.subnum=n[a][x].length-1),fb=!0):f[1]==x&&f[2]==n[a][f[1]].length-1?(2>n[a][x].length&&n[a].splice(x,1),x=null):1<g[a].dotline&&f[1]==x&&0==f[2]?(n[a][x].push(n[a][x][0]),x=null):(N("pendown"),n[a][x].push([d.x,d.y])):1==f[0]?(N("move"),q={mode:1,num:f[1]}):2==
f[0]?(N("move"),q={mode:2,num:f[1]}):5<=f[0]&&10>f[0]?null==A&&(N("move"),q={mode:f[0],num:f[1],subnum:f[2]},pb=e[a][f[1]][f[2]],fb=!0):10<=f[0]&&11>f[0]&&null==H&&(N("move"),q={mode:f[0],num:f[1],subnum:f[2]},pb=m[a][f[1]][f[2]],fb=!0);B()}else null!=x&&(2>n[a][x].length&&n[a].splice(x,1),N("pen")),null!=A&&(e[a][A].length<cb[g[a].mode]&&(e[a].splice(A,1),z[a].splice(A,1)),N("pen")),null!=H&&(3>m[a][H].length&&(m[a].splice(H,1),P[a].splice(H,1)),N("pen")),q=H=A=x=null,B(),a=null}function W(d,f){if(ha){var c=
Math.max(15*window.innerWidth/screen.width,15);c*=c}else c=-1==g[d].mode?50:25;if(0==g[d].mode||.5==g[d].mode||-1==g[d].mode)for(var b=n[d].length-1;0<=b;b--)for(var l=n[d][b].length-1;0<=l;l--){var t=Math.pow(n[d][b][l][0]-f.x,2)+Math.pow(n[d][b][l][1]-f.y,2);if(t<c)return[-1==g[d].mode?0:g[d].mode,b,l]}if(1==g[d].mode||-1==g[d].mode)for(b=M[d].length-1;0<=b;b--)if(Math.pow(M[d][b][0]-f.x,2)+Math.pow(M[d][b][1]-f.y,2)<c)return[1,b];if(2==g[d].mode||-1==g[d].mode)for(b=K[d].length-1;0<=b;b--)if(Math.pow(K[d][b][0]-
f.x,2)+Math.pow(K[d][b][1]-f.y,2)<c)return[2,b];if(5<=g[d].mode&&10>g[d].mode||-1==g[d].mode)for(b=e[d].length-1;0<=b;b--)for(l=e[d][b].length-1;0<=l;l--)if(z[d][b]==g[d].mode||-1==g[d].mode)if(t=Math.pow(e[d][b][l][0]-f.x,2)+Math.pow(e[d][b][l][1]-f.y,2),t<c)return[z[d][b],b,l];if(10<=g[d].mode&&11>g[d].mode||-1==g[d].mode)for(b=m[d].length-1;0<=b;b--)for(l=m[d][b].length-1;0<=l;l--)if(P[d][b]==g[d].mode||-1==g[d].mode)if(t=Math.pow(m[d][b][l][0]-f.x,2)+Math.pow(m[d][b][l][1]-f.y,2),t<c)return[P[d][b],
b,l];return null}function ca(d){var f=da(d);xa=!1;if(null!=a){if(Z[a].disabled)return;var c=sa(g[a].el),b={x:f.x-c.x,y:f.y-c.y};0<g[a].snaptogridx&&(b=ea(b,a));c=-1<b.x&&b.x<g[a].width&&-1<b.y&&b.y<g[a].height;1==fb&&(5<=g[a].mode&&10>g[a].mode?(e[a].push([[b.x,b.y]]),A=e[a].length-1,z[a][A]=g[a].mode):10<=g[a].mode&&11>g[a].mode&&(m[a].push([[b.x,b.y]]),H=m[a].length-1,P[a][H]=g[a].mode));null!=qb&&f.x==qb.x&&f.y==qb.y&&null!=x&&null==q&&(2>n[a][x].length&&n[a].splice(x,1),q=x=null,B());null!=x&&
null==q&&(.5==g[a].mode&&1<n[a][x].length?(dragobj=x=null,B()):.7==g[a].mode&&(dragobj=x=null,B()));null!=A&&1==e[a][A].length&&(eb||!c?(e[a].splice(A,1),z[a].splice(A,1),A=null,B()):null==W(a,b)&&(e[a][A].push([b.x,b.y]),A=null,B()));null!=H&&1==m[a][H].length&&(eb||!c?(m[a].splice(H,1),P[a].splice(H,1),H=null,B()):null==W(a,b)&&(m[a][H].push([b.x,b.y]),B()));null==x&&null==A?N("move"):N("pen");"undefined"!=typeof d&&d.preventDefault()}qb=f;null!=a&&null!=q&&(c=sa(g[a].el),-1<b.x&&b.x<g[a].width&&
-1<b.y&&b.y<g[a].height?(0==q.mode&&1<g[a].dotline&&(0==q.subnum||q.subnum==n[a][q.num].length-1)&&25>Math.pow(n[a][q.num][0][0]-n[a][q.num][n[a][q.num].length-1][0],2)+Math.pow(n[a][q.num][0][1]-n[a][q.num][n[a][q.num].length-1][1],2)&&(0==q.subnum?(n[a][q.num][n[a][q.num].length-1][0]=n[a][q.num][0][0],n[a][q.num][n[a][q.num].length-1][1]=n[a][q.num][0][1]):(n[a][q.num][0][0]=n[a][q.num][n[a][q.num].length-1][0],n[a][q.num][0][1]=n[a][q.num][n[a][q.num].length-1][1]),x=null,B()),q=null):(1==ia[a]&&
(b.y=g[a].imgheight/2),1==q.mode?M[a].splice(q.num,1):2==q.mode?K[a].splice(q.num,1):.5==q.mode?n[a].splice(q.num,1):0==q.mode?n[a][q.num][q.subnum]=pb:5<=q.mode&&10>q.mode?(e[a].splice(q.num,1),z[a].splice(q.num,1),A=null):10<=q.mode&&11>q.mode&&(m[a].splice(q.num,1),P[a].splice(q.num,1),H=null),q=null,B()));eb=!1;ha?Yb=window.setTimeout(function(){ha=!1;db();u(document).on("mousemove.imathasdraw",wa);u(".drawcanvas").on("touchstart.imathasdraw",function(l){ha=!0;aa(l)});u(document).on("mousedown.imathasdraw",
aa)},350):(db(),u(document).on("mousemove.imathasdraw",wa),u(".drawcanvas").on("touchstart.imathasdraw",function(l){ha=!0;aa(l)}),u(document).on("mousedown.imathasdraw",aa))}function wa(d){var f=null;fb=!1;var c=da(d);for(i in g)if(!u(g[i].el).is(":hidden")){var b=sa(g[i].el);if(b.x<c.x&&b.x+g[i].width>c.x&&b.y<c.y&&b.y+g[i].height>c.y&&d.target==g[i].el){f=i;break}}if(null!=f){if(Z[f].disabled)return;Ra=f;b=sa(g[f].el);var l={x:c.x-b.x,y:c.y-b.y};0<g[f].snaptogridx&&(l=ea(l,f));1==ia[f]&&(l.y=g[f].imgheight/
2);-1<l.x&&l.x<g[f].width&&-1<l.y&&l.y<g[f].height&&null==q&&null==x&&(b=W(f,l),null==b?N("pen",f):-1!=g[f].mode&&N("move",f))}else null!=Ra&&-1!=Ra&&(null!=a?B():(a=Ra,B(),a=null),Ra=-1);if(null!=a){if(d.originalEvent.touches&&1<d.originalEvent.touches.length)return eb=!0;"undefined"!=typeof d&&d.preventDefault();b=sa(g[a].el);l={x:c.x-b.x,y:c.y-b.y};0<g[a].snaptogridx&&(l=ea(l,a));1==ia[a]&&(l.y=g[a].imgheight/2);if(-1<l.x&&l.x<g[a].width&&-1<l.y&&l.y<g[a].height){if(null==q){if(xa&&-1==g[a].mode){b=
W(a,l);null!=b&&ra(b[0],b[1]);return}null!=x?!xa||0!=g[a].mode&&.7!=g[a].mode?xa&&.5==g[a].mode?(d=n[a][x].length-1,0==d?(d=Math.pow(n[a][x][d][0]-l.x,2)+Math.pow(n[a][x][d][1]-l.y,2),25<d?(n[a][x].push([l.x,l.y]),B()):B(l.x,l.y)):(n[a][x][d]=[l.x,l.y],B())):B(l.x,l.y):(d=n[a][x].length-1,d=Math.pow(n[a][x][d][0]-l.x,2)+Math.pow(n[a][x][d][1]-l.y,2),25<d?(n[a][x].push([l.x,l.y]),B()):B(l.x,l.y)):null!=A?xa?B():B(l.x,l.y):null!=H?xa?B():B(l.x,l.y):(b=W(a,l),null==b?(N("pen"),Cb.hasOwnProperty(g[a].mode)&&
null!==f&&B(l.x,l.y)):(B(),-1!=g[a].mode&&N("move")))}else N("move"),0==q.mode||.5==q.mode?n[a][q.num][q.subnum]=[l.x,l.y]:1==q.mode?M[a][q.num]=[l.x,l.y]:2==q.mode?K[a][q.num]=[l.x,l.y]:5<=q.mode&&10>q.mode?e[a][q.num][q.subnum]=[l.x,l.y]:10<=q.mode&&11>q.mode&&(m[a][q.num][q.subnum]=[l.x,l.y]),B();return!1}null==H||xa||B()}else null!=f&&-1!=Ra&&(a=f,Cb.hasOwnProperty(g[a].mode)&&B(l.x,l.y),a=null)}function N(d,f){f=f||a;g[f].cursor!=d&&(g[f].el.style.cursor="move"==d?d:"url("+imasroot+"/img/"+d+
".cur), auto",g[f].cursor=d)}function da(d){d=d||window.event;if(ha)return d=d.originalEvent.changedTouches[0]||d.originalEvent.touches[0],{x:d.pageX,y:d.pageY};if(d.pageX||d.pageY)return{x:d.pageX,y:d.pageY};var f=document.documentElement,c=document.body;if(f&&(f.scrollTop||f.scrollLeft)){var b=f.scrollLeft;f=f.scrollTop}else c?(b=c.scrollLeft,f=c.scrollTop):f=b=0;return{x:d.clientX+b,y:d.clientY+f}}function ea(d,f){var c=d.x-g[f].imgborder+g[f].xmin*g[f].pixperx,b=d.y-g[f].imgborder-g[f].ymax*g[f].pixpery;
c=Math.round(Math.round(c/(g[f].pixperx*g[f].snaptogridx))*g[f].pixperx*g[f].snaptogridx+g[f].imgborder-g[f].xmin*g[f].pixperx);b=Math.round(Math.round(b/(g[f].pixpery*g[f].snaptogridy))*g[f].pixpery*g[f].snaptogridy+g[f].imgborder+g[f].ymax*g[f].pixpery);return{x:c,y:b}}function Ia(d,f){var c=sa(d),b=da(f);return{x:b.x-c.x,y:b.y-c.y}}function sa(d){if(d.className.match(/hidden/))return{x:-1E4,y:-1E4};d=u(d).offset();return{x:d.left,y:d.top}}function db(){u(document).off("mousedown.imathasdraw").off("mousemove.imathasdraw").off("mouseup.imathasdraw");
u(document).off("touchstart.imathasdraw").off("touchmove.imathasdraw").off("touchend.imathasdraw").off("touchcancel.imathasdraw");u(".drawcanvas").off("touchstart.imathasdraw").off("touchmove.imathasdraw").off("touchend.imathasdraw").off("touchcancel.imathasdraw")}function gb(d){db();u(document).on("mousemove.imathasdraw",wa);u(".drawcanvas").on("touchstart.imathasdraw",function(t){ha=!0;aa(t)});u(document).on("mousedown.imathasdraw",aa);try{CanvasRenderingContext2D.prototype.dashedLine=function(t,
h,D,k,w){void 0==w&&(w=10);this.beginPath();this.moveTo(t,h);var v=D-t,y=k-h;w=Math.sqrt(v*v+y*y)/w;v/=w;y/=w;w=Math.floor(w);for(var I=0;I++<w&&-1<h&&h<g[a].imgheight+1&&-1<t&&t<g[a].imgwidth+1;)t+=v,h+=y,this[0==I%2?"moveTo":"lineTo"](t,h);this[0==I%2?"moveTo":"lineTo"](D,k);this.stroke();this.closePath()}}catch(t){}for(var f in canvases)if("undefined"==typeof d||d==f){var c=null;if(null!=drawla[f]&&2<drawla[f].length){n[canvases[f][0]]=drawla[f][0];M[canvases[f][0]]=drawla[f][1];K[canvases[f][0]]=
drawla[f][2];z[canvases[f][0]]=[];e[canvases[f][0]]=[];if(3<drawla[f].length&&0<drawla[f][3].length)for(var b=0;b<drawla[f][3].length;b++){z[canvases[f][0]][b]=drawla[f][3][b][0];e[canvases[f][0]][b]=[];for(var l=0;l<cb[z[canvases[f][0]][b]];l++)e[canvases[f][0]][b].push(drawla[f][3][b].slice(1+2*l,3+2*l))}P[canvases[f][0]]=[];m[canvases[f][0]]=[];if(4<drawla[f].length&&0<drawla[f][4].length)for(b=0;b<drawla[f][4].length;b++)P[canvases[f][0]][b]=drawla[f][4][b][0],m[canvases[f][0]][b]=[drawla[f][4][b].slice(1,
3),drawla[f][4][b].slice(3,5),drawla[f][4][b].slice(5)];5<drawla[f].length&&(c=drawla[f][5])}"a11ydraw"==canvases[f][1].substr(0,8)?U(canvases[f],c):(c="",canvases[f][1].match(/initPicture/)?c=canvases[f][1]:""!==canvases[f][1]&&(c=imasroot+"/filter/graph/imgs/"+canvases[f][1]),ya(canvases[f][0],"canvas"+canvases[f][0],c,"qn"+canvases[f][0],canvases[f][2],canvases[f][3],canvases[f][4],canvases[f][5],canvases[f][6],canvases[f][7],canvases[f][8],canvases[f][9],canvases[f][10],canvases[f][11],canvases[f][12]))}}
function Eb(d){for(var f,c=0;c<F.idnums.length;c++)if("undefined"==typeof d||d==F.idnums[c]){f=F.idnums[c];var b,l=f;var t=document.getElementById("qn"+l).value;if(b=t.match(/\(-oo,([\-\d\.]+)\)U\(([\-\d\.]+),oo\)/)){var h=3;t=b[1];b=b[2]}else(b=t.match(/\(-oo,([\-\d\.]+)\)/))?(h=0,t=b[1],b=2.5):(b=t.match(/\(([\-\d\.]+),oo\)/))?(h=1,t=b[1],b=2.5):(b=t.match(/\(([\-\d\.]+),([\-\d\.]+)\)/))?(h=2,t=b[1],b=b[2]):(h=0,t=-1.5,b=2.5);document.getElementById("slid1"+l).style.left=60*t+250-6+"px";document.getElementById("slid2"+
l).style.left=60*b+250-6+"px";document.getElementById("shaderegions"+l).selectedIndex=h;F.curslider.type=document.getElementById("shaderegions"+l).value;Zb(l);u("#slid1"+f).on("touchstart.normslider mousedown.normslider",$b);u("#slid2"+f).on("touchstart.normslider mousedown.normslider",$b)}}function $b(d){d=d||window.event;d.originalEvent.touches&&0<d.originalEvent.touches.length?(ha=!0,u(document).on("touchmove.normslider",ac),u(document).on("touchend.normslider",bc)):(u(document).on("mousemove.normslider",
ac),u(document).on("mouseup.normslider",bc));F.curslider.el=d.target||d.srcElement;F.curslider.id=F.curslider.el.id.substring(5);F.curslider.type=document.getElementById("shaderegions"+F.curslider.id).value;F.curslider.outnode=document.getElementById(F.outputid);F.curslider.startpos=Ia(F.curslider.el,d);F.curslider.el.parentNode.style.cursor="pointer";sa(F.curslider.el.parentNode);d.preventDefault&&d.preventDefault();return!1}function ac(d){var f=F.curslider.id;d=d||window.event;var c=Ia(F.curslider.el.parentNode,
d);if(!(5>c.x||c.x>F.curslider.el.parentNode.offsetWidth-5||5>c.y||c.y>F.curslider.el.parentNode.offsetHeight-5))return F.curslider.el.style.left=6*Math.round((c.x-F.curslider.startpos.x-10)/6)+10+"px",cc(f),d.preventDefault&&d.preventDefault(),!1}function bc(d){null!==F.curslider.el&&(ha=!1,u(document).off("touchmove.normslider touchend.normslider"),u(document).off("mousemove.normslider mouseup.normslider"),F.curslider.el.parentNode.style.cursor="",F.curslider.el=null)}function cc(d){var f=parseInt(document.getElementById("slid1"+
d).style.left)+6,c=parseInt(document.getElementById("slid2"+d).style.left)+6,b=Math.min(f,c),l=Math.max(f,c);"2O"==F.curslider.type?document.getElementById("normleft"+d).style.width=b+1+"px":"1L"==F.curslider.type?document.getElementById("normleft"+d).style.width=f+1+"px":"2B"==F.curslider.type&&(document.getElementById("normleft"+d).style.left=b+"px",document.getElementById("normleft"+d).style.width=l-b+1+"px");"2O"==F.curslider.type?document.getElementById("normright"+d).style.width=500-l+"px":
"1R"==F.curslider.type&&(document.getElementById("normright"+d).style.width=500-f+"px");b=(-4+(f-10)/60).toFixed(1);l=(-4+(c-10)/60).toFixed(1);var t=document.getElementById("slid1txt"+d);t.innerHTML=b;t.style.left=f-6+"px";f=document.getElementById("slid2txt"+d);f.innerHTML=l;f.style.left=c-6+"px";c=Math.min(b,l);f=Math.max(b,l);if("2O"==F.curslider.type)var h="(-oo,"+c+")U("+f+",oo)";else"2B"==F.curslider.type?h="("+c+","+f+")":"1L"==F.curslider.type?h="(-oo,"+b+")":"1R"==F.curslider.type&&(h="("+
b+",oo)");document.getElementById("qn"+d).value=h;u("#qn"+d).trigger("input").trigger("change")}function Zb(d){var f=document.getElementById("shaderegions"+d).value;F.curslider.type=f;var c=parseInt(document.getElementById("slid1"+d).style.left)+6,b=parseInt(document.getElementById("slid2"+d).style.left)+6,l=Math.min(c,b);b=Math.max(c,b);"1R"==f||"1L"==f?(document.getElementById("slid2"+d).style.display="none",document.getElementById("slid2txt"+d).style.display="none","1R"==f?(document.getElementById("normleft"+
d).style.display="none",document.getElementById("normright"+d).style.display="",document.getElementById("normright"+d).style.right="0px",document.getElementById("normright"+d).style.width=500-c+"px"):(document.getElementById("normright"+d).style.display="none",document.getElementById("normleft"+d).style.display="",document.getElementById("normleft"+d).style.left="0px",document.getElementById("normleft"+d).style.width=c+"px")):"2O"==f?(document.getElementById("slid2"+d).style.display="",document.getElementById("slid2txt"+
d).style.display="",document.getElementById("normleft"+d).style.display="",document.getElementById("normright"+d).style.display="",document.getElementById("normright"+d).style.right="0px",document.getElementById("normleft"+d).style.left="0px",document.getElementById("normright"+d).style.width=500-b+"px",document.getElementById("normleft"+d).style.width=l+"px"):"2B"==f&&(document.getElementById("slid2"+d).style.display="",document.getElementById("slid2txt"+d).style.display="",document.getElementById("normleft"+
d).style.display="",document.getElementById("normright"+d).style.display="none",document.getElementById("normleft"+d).style.left=l+"px",document.getElementById("normleft"+d).style.width=b-l+"px");cc(d)}var xa=!1,g=[],Ca=[],Z=[],n=[],M=[],K=[],e=[],z=[],m=[],P=[],x=null,ia=[],A=null,H=null,Gb=["rgb(0,0,255)","rgb(255,0,0)","rgb(0,255,0)"],dc=["rgba(0,0,255,.4)","rgba(255,0,0,.4)","rgba(0,255,0,.4)"],q=null,pb=null,a=null,Fb=!1,ha=!1,eb=!1,fb=!1,Yb=null,cb={5:2,"5.2":2,"5.3":2,"5.4":2,6:2,"6.1":2,"6.3":2,
"6.5":2,"6.6":2,7:2,"7.2":2,"7.4":2,"7.5":2,8:2,"8.2":2,"8.3":2,"8.4":2,"8.5":3,"8.6":3,9:2,"9.1":2,10:3,"10.2":3,"10.3":3,"10.4":3},Cb={"7.4":1,"7.5":1,"8.2":1,"8.5":1,"8.6":1},ic=0,qb=null,Ra=-1;"undefined"!=typeof initstack?initstack.push(gb):u(function(){gb()});var F={idnums:[],curslider:{el:null,startpos:[0,0],outnode:null}};"undefined"!=typeof initstack&&initstack.push(Eb);return{reset:function(){db();g.length=0;Ca.length=0;Z.length=0;n.length=0;M.length=0;K.length=0;e.length=0;z.length=0;m.length=
0;P.length=0;ia.length=0;H=A=q=x=a=null},initCanvases:gb,clearcanvas:function(d){Z[d].disabled||(n[d].length=0,M[d].length=0,K[d].length=0,e[d].length=0,z[d].length=0,m[d].length=0,P[d].length=0,a=d,"canvas"==g[d].type&&B(),q=x=a=null)},clearlastline:function(d){0<n[d].length&&--n[d].length;a=d;B();q=x=a=null},settool:function(d,f,c){for(var b=document.getElementById("drawtools"+f),l=b.getElementsByTagName("span"),t=0;t<l.length;t++)l[t].className="";l=b.getElementsByTagName("img");for(t=0;t<l.length;t++)l[t].className=
"";d.className="sel";g[f].mode=c;a=f;B()},addnormslider:function(d,f){-1==arraysearch(d,F.idnums)?(F.idnums.push(d),!0===f&&Eb(d)):Eb(d)},chgnormtype:Zb,adda11ydraw:S,changea11ydraw:function(d,f){var c=u(d).val();c=g[f].moderef[c];u(d).closest("li").find(".a11ydrawinstr").text(c.input);O()},encodea11ydraw:O,updatea11ydraw:function(d){var f=0,c=d.value.trim();if("("!=c.charAt(0)||")"!=c.slice(-1))f|=1;var b=c.slice(1,-1).split(/\)\s*,\s*\(/);c=d.getAttribute("data-n");c.match(/\d/)&&b.length!=parseInt(c)&&
(f|=2);for(var l=0;l<b.length;l++){var t=b[l].split(/,/);2!=t.length&&(f|=1);for(var h=0;h<t.length;h++)0==t[h].trim().length&&(f|=1)}"noticetext"==d.parentNode.parentNode.lastChild.className&&d.parentNode.parentNode.removeChild(d.parentNode.parentNode.lastChild);f?(d.setAttribute("aria-invalid",!0),b=document.createElement("span"),b.id=uniqid("a11ydrawerr"),b.className="noticetext",1==(f&1)?(b.innerHTML="<br>"+_("Error: Invalid format for points. Give points as open parenthesis number comma number close parenthesis. Separate points with a comma."),
setariastatus(_("Error: Invalid format for points"))):(b.innerHTML="<br>"+_("Error: Incorrect number of points. Expecting ")+c,setariastatus(_("Error: Incorrect number of points"))),d.parentNode.parentNode.appendChild(b),d.setAttribute("aria-describedby",b.id)):(d.removeAttribute("aria-invalid"),d.removeAttribute("aria-describedby"),setariastatus(""));d=parseInt(u(d).closest(".a11ydraw").attr("id").substring(8));O(d)},removea11ydraw:function(d){setariastatus(_("Removed drawing element"));var f=u(d).closest("ul");
u(d).parent().remove();f.find("li").each(function(c,b){var l=_("Drawing element ")+(c+1);u(b).find(".draweln").html(l)});f.prev().focus();O(f.attr("id").substring(8))}}}(jQuery);
(function(){function u(U,S,L,O,ya){for(var B=O,ra,aa=S+1;aa<L;aa++){var W=U[aa];var ca=U[S],wa=U[L],N=ca[0];ca=ca[1];var da=wa[0]-N,ea=wa[1]-ca;if(0!==da||0!==ea){var Ia=((W[0]-N)*da+(W[1]-ca)*ea)/(da*da+ea*ea);1<Ia?(N=wa[0],ca=wa[1]):0<Ia&&(N+=da*Ia,ca+=ea*Ia)}da=W[0]-N;ea=W[1]-ca;W=da*da+ea*ea;W>B&&(ra=aa,B=W)}B>O&&(1<ra-S&&u(U,S,ra,O,ya),ya.push(U[ra]),1<L-ra&&u(U,ra,L,O,ya))}window.pathsimplify=function(U,S,L){if(2>=U.length)return U;S=void 0!==S?S*S:1;if(L)var O=U;else{L=U[0];for(var ya=[L],
B=1,ra=U.length;B<ra;B++){O=U[B];var aa=O[0]-L[0],W=O[1]-L[1];aa*aa+W*W>S&&(ya.push(O),L=O)}L!==O&&ya.push(O);O=ya}U=O.length-1;L=[O[0]];u(O,0,U,S,L);L.push(O[U]);return L}})();

var ehcurel=null,ehclosetimer=0,ehddclosetimer=0,curehdd=null,eecurel=null;function showeh(a){if(null==eecurel){unhideeh(0);var c=document.getElementById(a),b=document.getElementById("eh");a!=ehcurel?(ehcurel=a,a=jQuery(c).offset(),b.style.display="block",b.style.left=a.left+"px",b.style.top=a.top+c.offsetHeight+"px"):(b.style.display="none",ehcurel=null);c.focus()}}
function reshrinkeh(a){null==eecurel&&a==ehcurel&&(document.getElementById("ehdd").style.display="block",document.getElementById("eh").style.display="none",ehcurel=null,curehdd=a,unhideeh(0))}function unhideeh(a){ehcancelclosetimer()}function hideeh(a){null==ehcurel?ehddclosetimer=window.setTimeout(function(){curehdd=null;document.getElementById("ehdd").style.display="none"},250):ehclosetimer=window.setTimeout(reallyhideeh,250)}
function reallyhideeh(){document.getElementById("eh").style.display="none";ehcurel=null}function ehcancelclosetimer(){ehclosetimer&&(window.clearTimeout(ehclosetimer),ehclosetimer=null)}function hideAllEhTips(){ehclosetimer&&(window.clearTimeout(ehclosetimer),ehclosetimer=null);ehddclosetimer&&(window.clearTimeout(ehddclosetimer),ehddclosetimer=null);curehdd=null;document.getElementById("ehdd").style.display="none";document.getElementById("eh").style.display="none"}
function showehdd(a,c,b){if((null==eecurel||eecurel!=a)&&null!=document.getElementById("tips"+b)){ehddclosetimer&&a!=curehdd&&(window.clearTimeout(ehddclosetimer),ehddclosetimer=null);if(a!=ehcurel){var d=document.getElementById("ehdd"),e=document.getElementById(a),f=jQuery(e).offset();document.getElementById("ehddtext").innerHTML=c;document.getElementById("eh").innerHTML=document.getElementById("tips"+b).innerHTML;d.style.display="block";d.style.left=f.left+"px";d.style.top=f.top+e.offsetHeight+
"px"}curehdd=a}}function updateehpos(){if(curehdd||ehcurel){var a=document.getElementById("eh"),c=document.getElementById("ehdd"),b=document.getElementById(curehdd||ehcurel),d=jQuery(b).offset();a.style.left=d.left+"px";a.style.top=d.top+b.offsetHeight+"px";c.style.left=d.left+"px";c.style.top=d.top+b.offsetHeight+"px"}};
